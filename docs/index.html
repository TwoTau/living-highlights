<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0"/>
    <meta charset="utf-8" />
    <title>Living Highlights</title>
    <meta property="og:title" content="Living Highlights" />
    <meta property="og:type" content="article" />
    <meta property="og:description" content="Living Highlights" />
    <meta property="description" content="Living Highlights" />
    <style>
article{--section-prefix:"§";--equation-prefix:"Equation ";--figure-prefix:"Figure ";--table-prefix:"Table ";--cite-list-start:"[";--cite-list-end:"]";--double-quote-start:"“";--double-quote-end:"”";--single-quote-start:"‘";--single-quote-end:"’";--highlight-color:#ff0;--tiny-size:0.5em;--script-size:0.7em;--smaller-size:0.8em;--small-size:0.9em;--large-size:1.2em;--larger-size:1.4em;--huge-size:1.8em;--inline-math-size:1em;--ref-color:steelblue;--ref-color-light:#c8dae9;--ref-color-hover:#90b4d2;--ref-color-error:maroon;--ref-weight:500;--ref-decoration:none;width:var(--article-width);margin-left:var(--article-margin-left);padding:var(--article-padding);--inline-math-size:1.14em}a{color:var(--ref-color);font-weight:var(--ref-weight);text-decoration:var(--ref-decoration)}a:hover{color:var(--ref-color-hover)}sub,sup{line-height:0}q{quotes:var(--double-quote-start) var(--double-quote-end)}q.single{quotes:var(--single-quote-start) var(--single-quote-end)}blockquote{margin-left:2em}.action{cursor:pointer;text-decoration:underline dashed 1px #444}header h1{font-size:var(--huge-size)}header .author-org{font-style:italic}header .author-org::before{content:" · "}h1{font-size:1.4rem}h2{font-size:1.2rem}h3{font-size:1.1rem}h4,h5,h6{font-size:1rem}h1[data-counter]::before,h2[data-counter]::before,h3[data-counter]::before{content:attr(data-counter) " "}figure.figure>figcaption[data-counter]::before,figure.teaser>figcaption[data-counter]::before{content:var(--figure-prefix) attr(data-counter) ". "}figure.table>figcaption[data-counter]::before{content:var(--table-prefix) attr(data-counter) ". "}table{border-spacing:0;border-collapse:collapse}thead tr{border-bottom:1px solid #ccc}tbody td,thead th{font-size:var(--small-size);padding:1px .33em;text-align:left;font-variant-numeric:tabular-nums}tbody tr{border-bottom:1px solid #eee}ol.references{padding-inline-start:2em}ol.references li{font-size:var(--small-size);margin-bottom:6px}:root{--max-article-width:110ex;--article-padding:32px;--toc-width:300px;--margin-width:400px;--gap-width:100px;--article-width:min(var(--max-article-width), calc(100vw - var(--article-padding) * 2 - var(--gap-width) * 2 - var(--toc-width) - var(--margin-width)));--article-margin-left:max(0px, calc(((100vw + var(--toc-width) - var(--article-width) - var(--gap-width) * 2 - var(--margin-width)) / 2)));--highlight-color:#FAFA44}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit;margin:0;padding:0}h1,h2,h3{padding:0}h1{padding-top:.5em}.title{font-size:24pt;font-weight:700}ol,p,pre,table,ul{margin:0}ol,ul{padding-left:1.5em}section>p{margin-bottom:16px}section>p:last-child{margin-bottom:0}.margin,aside{position:relative;float:right;clear:right;width:var(--margin-width);margin-right:calc(-1 * var(--gap-width) - var(--margin-width));margin-bottom:1em;vertical-align:unset}aside{margin-left:0;margin-top:0}aside>:first-child{margin-top:0}aside>:last-child{margin-bottom:0}.inlinenote-number{line-height:1;padding:1px}.float-left{float:left;margin-right:1em}.float-right{float:right;margin-left:1em}.sticky{position:sticky;top:0;z-index:10}.page{text-align:justify;width:calc(100vw - 2 * var(--article-padding) - 2 * var(--article-margin-left))}figure,pre{max-width:calc(100vw - 2 * var(--article-padding) - 2 * var(--article-margin-left));overflow-x:auto}.full{max-width:100vw}.full-image{width:100%;object-fit:cover;vertical-align:middle}.full figcaption{background:#eee;padding:16px 0}.centered{text-align:center}figure{margin:0;padding:5px 0}aside canvas,aside img,aside svg,figure canvas,figure img,figure svg{object-fit:contain;max-width:100%;height:auto}header{padding-bottom:1em}footer{padding:2em 0}@media (max-width:1600px){:root{--article-width:min(var(--max-article-width), calc(100vw - var(--article-padding) * 2 - var(--gap-width) - var(--margin-width)));--article-margin-left:max(0px, calc(((100vw - var(--article-width) - var(--gap-width) - var(--margin-width)) / 2)))}table-of-contents{display:none}}@media (max-width:1100px){:root{--article-padding:16px}article{width:min(var(--max-article-width),calc(100% - var(--article-padding) * 2))}figure,pre{max-width:calc(100vw - var(--article-padding) * 2)}.page{width:min(var(--max-article-width),100%)}.margin,aside{float:none;margin:0;width:auto}.inline-note-number{cursor:pointer;padding:1px 4px}.inline-note .note::before,.inline-note:not(.open) .note{display:none}}@media print{.sticky{position:relative}}table-of-contents{position:fixed;top:calc(2 * var(--article-padding));left:calc(var(--article-margin-left) - var(--toc-width));height:calc(100vh - 4 * var(--article-padding));overflow-y:auto}table-of-contents ol{width:fit-content;max-width:var(--toc-width);margin:0;padding-left:0;list-style:none}table-of-contents li{margin:1ex 0;padding-left:16px;border-left:2px solid #212e6d11}table-of-contents li:hover{border-left-width:4px;padding-left:14px}table-of-contents li.active{border-color:#000}table-of-contents li.active-parent>a{color:#000}table-of-contents li.active>a{font-weight:700}table-of-contents a{font-weight:inherit}:not(.katex-display)>.katex{font-size:var(--inline-math-size)!important}.math-aug-window{z-index:99;position:absolute;border-bottom:2px solid #000;transform:translate(-50px,-40px);background:#fff;border-radius:2px;padding:1px 5px;filter:drop-shadow(1px 1px 2px rgba(0, 0, 0, .2))}.anno-tray{width:420px;overflow-y:auto;height:100vh;background-color:rgba(128,128,128,.3);backdrop-filter:blur(5px);border-left:1px solid #262932;box-sizing:border-box;-ms-overflow-style:none;scrollbar-width:none}.anno-tray::-webkit-scrollbar{display:none}.anno-threads{position:absolute;display:flex;align-items:center;justify-content:space-between;flex-direction:column;width:100%;height:auto;top:50px;padding-top:10px}.thread-info{display:flex;flex-direction:row;font-weight:bolder;font-size:larger;justify-content:space-between;padding:10px;border-bottom:1px solid #262932}.thread-type{width:100px;text-align:right}.thread-text{padding:10px;height:100px;overflow:auto;font-style:italic;-ms-overflow-style:none;scrollbar-width:none}.thread-text::-webkit-scrollbar{display:none}.thread-username{width:200px;text-align:left}.thread-username::before{content:'@'}.thread-datetime{display:flex;justify-content:right;align-items:right;padding:10px;font-size:x-small}.thread-comment{min-height:20px;padding:10px}.thread-comment::before{content:"- "}.thread{background-color:rgba(150,150,150,.6);min-height:150px;width:380px;margin:10px;border-radius:5px;overflow:hidden;border:1px solid #262932}.home{display:flex;width:20%;height:100%;text-align:center;align-items:center;justify-content:center;border-right:1px solid #262932}.title{display:flex;width:80%;height:100%;text-align:center;align-items:center;justify-content:center}.top-nav{position:sticky;z-index:1;top:0;background-color:#d9d6cd;width:100%;height:50px;display:flex;flex-direction:row;justify-content:space-around;align-items:center;border-bottom:1px solid #262932}.anno-side-tray{position:absolute;display:flex;top:0;right:420px;width:30px;height:300px;overflow:hidden;background-color:transparent;border-bottom-left-radius:30px;transition:width .6s cubic-bezier(.05, .4, .25, .95),height .6s cubic-bezier(.05, .4, .25, .95);justify-content:right}.anno-button{position:absolute;justify-content:center;align-items:center;display:flex;box-sizing:border-box;top:200px;height:100px;width:30px;background:#d9d6cd;cursor:pointer;color:#000;font-size:1.4em;text-align:center;z-index:2;border-bottom-left-radius:30px;border-left:1px solid #262932;border-bottom:1px solid #262932;transition:transform .6s cubic-bezier(.05, .4, .25, .95)}.anno-color{position:absolute;left:90px;top:104px;height:80px}.anno-color-button{position:absolute;justify-content:center;align-items:center;display:flex;background-color:#d9d6cd;box-sizing:border-box;height:31px;width:30px;top:169px;font-weight:bolder;border:1px solid #262932;border-right:none;transition:transform .6s cubic-bezier(.05, .4, .25, .95);z-index:4}.anno{top:0;z-index:99;right:-420px;position:fixed;transition:transform .9s cubic-bezier(.05, .4, .25, .95)}.annotation-highlight{background:var(--highlight-color);cursor:pointer;transition:filter .1s ease-out}.annotation-highlight:hover,.hovered,.thread:hover{filter:brightness(85%)}.annotation-highlight:hover{padding:2px;margin:0 -2px}body{font:16px/1.5 -apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";background:#fff;color:#000}:not(pre)>code,pre{font-family:monospace;font-size:15px}h1,h2,h3,h4,h5,h6{font-weight:600;line-height:1.25em;margin:24px 0 16px}h1,h2{border-bottom:1px solid rgba(0,0,0,.1);padding-bottom:6px;width:fit-content}.katex-display,article p,article>ol,article>table,article>ul{margin:12px 0}td,th{border-bottom:1px solid rgba(0,0,0,.2);transition:.1s ease-out}th,tr:hover td{background:rgba(0,0,0,.1)}figure>figcaption{font-weight:600;font-size:var(--small-size);line-height:1.4em;padding-bottom:1ex}.sticky{background:rgba(255,255,255,.8);backdrop-filter:blur(4px)}.note,aside{font-style:inherit;font-size:var(--small-size)}.note{background:#fff;transition:.1s ease-out}.inline-note:hover .inline-note-number,.inline-note:hover .note{background:var(--ref-color-light)}.inline-note .note::before{font-size:var(--smaller-size)}.normal{font-weight:400}.demi{font-weight:600}.bold,.strong{font-weight:700}.code,.mono{font-family:monospace}.em,.emph,.italic{font-style:italic}.highlight{background-color:var(--highlight-color)}.strike{text-decoration:line-through}.underline{text-decoration:underline}.smallcaps{font-variant:small-caps}.lowercase{text-transform:lowercase}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.left{text-align:left}.right{text-align:right}.center{text-align:center}.justify{text-align:justify}.tiny{font-size:var(--tiny-size)}.scriptsize{font-size:var(--script-size)}.footnotesize,.smaller{font-size:var(--smaller-size)}.small{font-size:var(--small-size)}.large{font-size:var(--large-size)}.larger{font-size:var(--larger-size)}.huge{font-size:var(--huge-size)}.hide{display:none}.sticky:has(#fig2){top:32px}.maug{color:#8a2be2;display:inline-block;cursor:pointer}.maug:hover{background:rgba(103,176,202,.22)}.maug-fxh{color:#00f}.maug-dxh{color:#00008b}.maug-fprimeprimex{color:#8b0000}.maug-alpha{color:#db7093}.maug-beta{color:#663399}.maug-fx{color:#00f}.maug-gx{color:#006400}.maug-fprimex{color:#00008b}.maug-gprimex{color:#556b2f}.maug-wx{color:#8b0000}.maug-h{color:purple}.maug-x{color:red}.maug-r{color:orange}.maug-m,.maug-n{color:sienna}.maug-a{color:#8b0000}.maug-5{color:sienna}:root,[data-theme=default]{--base-background-color:rgba(38, 41, 50, 1.0);--thumb-border-color:rgba(255, 255, 255, 0.7);--color-wheel-control-box-shadow:0px 0px 5px 0px rgba(0, 0, 0, 0.85) inset;--brightness-control-box-shadow:0px 0px 5px 0px rgba(0, 0, 0, 0.5) inset;--input-controls-tab-header-background-color:rgba(41, 45, 53, 1.0);--input-controls-tab-header-font-color:rgba(255, 255, 255, 1.0);--input-controls-tab-background-color:rgba(0, 0, 0, 0.1);--range-input-control-background-color:rgba(55, 61, 71, 0.6);--range-input-control-background-color--focused:rgba(55, 61, 71, 0.5);--range-input-control-font-color:rgba(255, 255, 255, 1.0);--range-input-control-selection-color:rgba(0, 0, 0, 0.5);--range-input-control-progress-color:rgba(37, 43, 48, 1.0);--text-input-control-background-color:rgba(55, 61, 71, 0.6);--text-input-control-background-color--focused:rgba(55, 61, 71, 0.5);--text-input-control-font-color:rgba(255, 255, 255, 1.0);--text-input-control-selection-color:rgba(0, 0, 0, 0.5)}[data-theme=light]{--base-background-color:rgba(217, 214, 205, 1.0);--thumb-border-color:rgba(255, 255, 255, 0.7);--color-wheel-control-box-shadow:0px 0px 5px 0px rgba(0, 0, 0, 0.45) inset;--brightness-control-box-shadow:0px 0px 5px 0px rgba(0, 0, 0, 0.25) inset;--input-controls-tab-header-background-color:rgba(221, 218, 210, 1.0);--input-controls-tab-header-font-color:rgba(35, 35, 35, 1.0);--input-controls-tab-background-color:rgba(122, 122, 122, 0.1);--range-input-control-background-color:rgba(221, 218, 210, 0.6);--range-input-control-background-color--focused:rgba(222, 220, 220, 0.5);--range-input-control-font-color:rgba(35, 35, 35, 1.0);--range-input-control-selection-color:rgba(255, 255, 255, 0.5);--range-input-control-progress-color:rgba(228, 228, 228, 1.0);--text-input-control-background-color:rgba(221, 218, 210, 0.6);--text-input-control-background-color--focused:rgba(222, 220, 220, 0.5);--text-input-control-font-color:rgba(35, 35, 35, 1.0);--text-input-control-selection-color:rgba(255, 255, 255, 0.5)}.color-picker{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:180px;height:auto;min-height:226px;box-sizing:border-box;border-left:1px solid #262932;border-bottom:1px solid #262932;background:var(--base-background-color);border-bottom-left-radius:5px;-webkit-box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);-moz-box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12)}.color-picker-controls{position:relative;width:100%;height:auto;display:flex;flex-direction:column}.color-picker-controls-group{position:relative;display:block;align-items:center;width:auto;padding:10px}.color-picker-wheel-control{position:relative;display:flex;flex-direction:row;height:140px;width:140px;border:none}.color-picker-wheel-control::after{content:'';position:absolute;display:block;top:0;left:0;width:100%;height:100%;border:1px solid var(--base-background-color);border-radius:50%;-webkit-box-shadow:var(--color-wheel-control-box-shadow);-moz-box-shadow:var(--color-wheel-control-box-shadow);box-shadow:var(--color-wheel-control-box-shadow);margin:-1px;pointer-events:none}.color-picker-brightness-control{position:relative;display:flex;flex-direction:row;height:100%;width:8px;border:1px solid transparent;border-radius:3px;margin-right:10px}.color-picker-brightness-control::after{content:'';position:absolute;display:block;top:0;left:0;width:100%;height:100%;border-radius:3px;-webkit-box-shadow:var(--brightness-control-box-shadow);-moz-box-shadow:var(--brightness-control-box-shadow);box-shadow:var(--brightness-control-box-shadow);pointer-events:none}.color-picker-brightness-control-thumb,.color-picker-wheel-control-thumb{position:absolute;display:block;width:10px;height:10px;border:1px solid var(--thumb-border-color);border-radius:50%;-webkit-box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);-moz-box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);box-shadow:0 3px 1px -2px rgba(0,0,0,.2),0 2px 2px 0 rgba(0,0,0,.14),0 1px 5px 0 rgba(0,0,0,.12);cursor:pointer;z-index:1}.brightness-canvas,.wheel-canvas{width:100%;height:100%;border-radius:3px}.color-picker-input-controls{position:relative;width:100%;height:100%;display:flex;flex-direction:column;background:var(--input-controls-tab-background-color);border-radius:3px;overflow:hidden}.color-picker-input-controls-tab-headers{position:relative;display:flex;flex-direction:row;width:100%;height:25px;overflow:hidden}.color-picker-input-controls-tab-headers button{position:relative;display:block;width:33.33%;height:100%;background:var(--input-controls-tab-header-background-color);font-size:9px;color:var(--input-controls-tab-header-font-color);border:none;outline:0}.color-picker-input-controls-tab-headers button.selected{background:0 0}.color-picker-input-controls-tabs{position:relative;display:block;width:100%;height:auto;padding:4px}.color-picker-input-controls-tab{position:relative;display:flex;flex-direction:column}.color-picker-input-controls-tab:not(.selected){display:none}input{font-size:100%}input::-webkit-inner-spin-button,input::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}input[type=number]{-moz-appearance:textfield}.range-input-control{position:relative;display:block;width:100%;height:auto;min-height:20px;margin:1px 0 0;background:var(--range-input-control-background-color);font-size:10px;cursor:ew-resize;overflow:hidden}.range-input-control.range-input-control--focused,.range-input-control:hover{background:var(--range-input-control-background-color--focused)}.range-input-control:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.range-input-control:last-child{border-bottom-left-radius:3px;border-bottom-right-radius:3px}.range-input-control .range-input-details-block,.range-input-control .range-input-enter-block{position:absolute;display:block;top:0;left:0;right:0;bottom:0}.range-input-control:not(.range-input-control--key-input-mode) .range-input-enter-block{display:none}.range-input-control.range-input-control--key-input-mode .range-input-enter-block,.range-input-control:not(.range-input-control--key-input-mode) .range-input-details-block{display:block}.range-input-control.range-input-control--key-input-mode .range-input-details-block{display:none}.range-input-control input{position:absolute;display:block;top:50%;transform:translate(0,-50%);width:100%;height:auto;background:0 0;border:none;color:var(--range-input-control-font-color);text-align:center;outline:0}.range-input-control input::-moz-selection{background:var(--range-input-control-selection-color)}.range-input-control input::selection{background:var(--range-input-control-selection-color)}.range-input-control .range-input-progress{position:absolute;display:block;top:0;left:0;height:100%;background:var(--range-input-control-progress-color)}.range-input-control .range-input-label,.range-input-control .range-input-value{position:absolute;display:block;top:50%;width:auto;height:auto;transform:translate(0,-50%);color:var(--range-input-control-font-color);pointer-events:none}.range-input-control .range-input-label{left:5px}.range-input-control .range-input-value{right:5px}.text-input-control{position:relative;display:block;width:100%;height:auto;min-height:20px;background:var(--text-input-control-background-color);font-size:10px;margin:1px 0 0;cursor:text;overflow:hidden}.text-input-control.text-input-control--focused,.text-input-control:hover{background:var(--text-input-control-background-color--focused)}.text-input-control:first-child{border-top-left-radius:3px;border-top-right-radius:3px}.text-input-control:last-child{border-bottom-left-radius:3px;border-bottom-right-radius:3px}.text-input-control .text-input-details-block,.text-input-control .text-input-enter-block{position:absolute;display:block;top:0;left:0;right:0;bottom:0}.text-input-control:not(.text-input-control--focused) .text-input-enter-block{display:none}.text-input-control.text-input-control--focused .text-input-enter-block,.text-input-control:not(.text-input-control--focused) .text-input-details-block{display:block}.text-input-control.text-input-control--focused .text-input-details-block{display:none}.text-input-control input{position:absolute;display:block;top:50%;transform:translate(0,-50%);width:100%;height:auto;background:0 0;color:var(--text-input-control-font-color);text-align:center;border:none;outline:0}.text-input-control input::-moz-selection{background:var(--text-input-control-selection-color)}.text-input-control input::selection{background:var(--text-input-control-selection-color)}.text-input-control .text-input-label,.text-input-control .text-input-value{position:absolute;display:block;top:50%;width:auto;height:auto;transform:translate(0,-50%);color:var(--text-input-control-font-color);pointer-events:none}.text-input-control .text-input-label{left:5px}.text-input-control .text-input-value{right:5px}
    </style>
  </head>
  <body>
    <article><table-of-contents><ol><li>Abstract<ol></ol></li><li><a href="#goals">Goals</a><ol></ol></li><li><a href="#related-work">Related work</a><ol></ol></li><li><a href="#implementation">Implementation</a><ol><li><a href="#ui">UI</a><ol></ol></li><li><a href="#text-fragments">Text fragments</a><ol></ol></li><li><a href="#twitter-web-intents">Twitter web intents</a><ol></ol></li><li><a href="#living-highlights-server">Living Highlights server</a><ol></ol></li></ol></li><li><a href="#limitations">Limitations</a><ol><li><a href="#early-adoption">(Early) adoption</a><ol></ol></li><li><a href="#day-search-limit">7-day search limit</a><ol></ol></li><li><a href="#equation-highlighting">Equation highlighting</a><ol></ol></li><li><a href="#text-fragment-generation">Text fragment generation</a><ol></ol></li><li><a href="#recent-events-at-twitter">Recent events at Twitter</a><ol></ol></li></ol></li></ol></table-of-contents><header><h1 role="banner">Living Highlights</h1><div class="author"><span class="author-name">Vishal Devireddy</span><span class="author-org">University of Washington</span></div><div class="author"><span class="author-name">Tu Nguyen</span><span class="author-org">University of Washington</span></div></header><p><annotation-thread></annotation-thread></p><h1 nonumber="true">Abstract</h1><p>This project adds social annotations via Tweets to Living Papers documents.</p><h1 id="goals" data-counter="1">Goals</h1><p>todo</p><h1 id="related-work" data-counter="2">Related work</h1><p>todo: see references</p><h1 id="implementation" data-counter="3">Implementation</h1><p>The main components of our implementation are the UI, Text Fragments, Twitter web intents, and our server that searches Twitter.</p><h2 id="ui" data-counter="3.1">UI</h2><p>todo: Tu</p><h2 id="text-fragments" data-counter="3.2">Text fragments</h2><p><a href="https://web.dev/text-fragments/">Text fragments</a> are</p><h2 id="twitter-web-intents" data-counter="3.3">Twitter web intents</h2><p>todo</p><h2 id="living-highlights-server" data-counter="3.4">Living Highlights server</h2><p>We need a server to use the Twitter API.</p><h1 id="limitations" data-counter="4">Limitations</h1><h2 id="early-adoption" data-counter="4.1">(Early) adoption</h2>Systemic reform always faces a bootstrap problem: early adopters gain little benefit (because no one else is participating in the new system yet) and suffer high costs.—Christopher Lee, author of the now discontinued Selected-Papers Network<p>Early adoption is the biggest problem that all social annotation platforms face.</p><h2 id="day-search-limit" data-counter="4.2">7-day search limit</h2><p>Twitter limits API users to only searching through the past week of Tweets.</p><h2 id="equation-highlighting" data-counter="4.3">Equation highlighting</h2><p>Currently, highlighting equations sometimes leads to slightly incorrect tweet text. For example, if you highlight part of this equation <tex-math mode="inline" code="F(@x + @h) \approx F(@x) + @hF&#39;(@x)" definitions="[{&quot;replace&quot;:&quot;F(@x + @h)&quot;,&quot;symbol&quot;:&quot;F(@x + @h)&quot;,&quot;id&quot;:&quot;fxh&quot;,&quot;definition&quot;:&quot;The best translated $F(@x)$ to approximate $G(@x)$&quot;},{&quot;replace&quot;:&quot;F&#39;(@x)&quot;,&quot;symbol&quot;:&quot;F&#39;(@x)&quot;,&quot;id&quot;:&quot;fprimex&quot;,&quot;definition&quot;:&quot;Linear approximation of $F(x)$ in the neighborhood of $@x$&quot;},{&quot;replace&quot;:&quot;F(@x)&quot;,&quot;symbol&quot;:&quot;F(@x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(@x)&quot;,&quot;symbol&quot;:&quot;G(@x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;F(x)&quot;,&quot;symbol&quot;:&quot;F(x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(x)&quot;,&quot;symbol&quot;:&quot;G(x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;@h&quot;,&quot;symbol&quot;:&quot;h&quot;,&quot;id&quot;:&quot;h&quot;,&quot;definition&quot;:&quot;disparity vector&quot;},{&quot;replace&quot;:&quot;@x&quot;,&quot;symbol&quot;:&quot;x&quot;,&quot;id&quot;:&quot;x&quot;,&quot;definition&quot;:&quot;position vector in an image&quot;},{&quot;replace&quot;:&quot;@R&quot;,&quot;symbol&quot;:&quot;R&quot;,&quot;id&quot;:&quot;r&quot;,&quot;definition&quot;:&quot;Region of interest&quot;}]"></tex-math> describing <tex-math mode="inline" code="F(@x)" definitions="[{&quot;replace&quot;:&quot;F(@x + @h)&quot;,&quot;symbol&quot;:&quot;F(@x + @h)&quot;,&quot;id&quot;:&quot;fxh&quot;,&quot;definition&quot;:&quot;The best translated $F(@x)$ to approximate $G(@x)$&quot;},{&quot;replace&quot;:&quot;F&#39;(@x)&quot;,&quot;symbol&quot;:&quot;F&#39;(@x)&quot;,&quot;id&quot;:&quot;fprimex&quot;,&quot;definition&quot;:&quot;Linear approximation of $F(x)$ in the neighborhood of $@x$&quot;},{&quot;replace&quot;:&quot;F(@x)&quot;,&quot;symbol&quot;:&quot;F(@x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(@x)&quot;,&quot;symbol&quot;:&quot;G(@x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;F(x)&quot;,&quot;symbol&quot;:&quot;F(x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(x)&quot;,&quot;symbol&quot;:&quot;G(x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;@h&quot;,&quot;symbol&quot;:&quot;h&quot;,&quot;id&quot;:&quot;h&quot;,&quot;definition&quot;:&quot;disparity vector&quot;},{&quot;replace&quot;:&quot;@x&quot;,&quot;symbol&quot;:&quot;x&quot;,&quot;id&quot;:&quot;x&quot;,&quot;definition&quot;:&quot;position vector in an image&quot;},{&quot;replace&quot;:&quot;@R&quot;,&quot;symbol&quot;:&quot;R&quot;,&quot;id&quot;:&quot;r&quot;,&quot;definition&quot;:&quot;Region of interest&quot;}]"></tex-math> and <tex-math mode="inline" code="F&#39;(@x)" definitions="[{&quot;replace&quot;:&quot;F(@x + @h)&quot;,&quot;symbol&quot;:&quot;F(@x + @h)&quot;,&quot;id&quot;:&quot;fxh&quot;,&quot;definition&quot;:&quot;The best translated $F(@x)$ to approximate $G(@x)$&quot;},{&quot;replace&quot;:&quot;F&#39;(@x)&quot;,&quot;symbol&quot;:&quot;F&#39;(@x)&quot;,&quot;id&quot;:&quot;fprimex&quot;,&quot;definition&quot;:&quot;Linear approximation of $F(x)$ in the neighborhood of $@x$&quot;},{&quot;replace&quot;:&quot;F(@x)&quot;,&quot;symbol&quot;:&quot;F(@x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(@x)&quot;,&quot;symbol&quot;:&quot;G(@x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;F(x)&quot;,&quot;symbol&quot;:&quot;F(x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(x)&quot;,&quot;symbol&quot;:&quot;G(x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;@h&quot;,&quot;symbol&quot;:&quot;h&quot;,&quot;id&quot;:&quot;h&quot;,&quot;definition&quot;:&quot;disparity vector&quot;},{&quot;replace&quot;:&quot;@x&quot;,&quot;symbol&quot;:&quot;x&quot;,&quot;id&quot;:&quot;x&quot;,&quot;definition&quot;:&quot;position vector in an image&quot;},{&quot;replace&quot;:&quot;@R&quot;,&quot;symbol&quot;:&quot;R&quot;,&quot;id&quot;:&quot;r&quot;,&quot;definition&quot;:&quot;Region of interest&quot;}]"></tex-math> and open the Tweet intent, you will get a correct result:</p><pre><code>&quot;this equation F(x+h)≈F(x)+hF′(x) describing&quot;</code></pre><p>but highlighting a equation with fractions <tex-math mode="inline" code="L_2 \, \text{norm} = (\sum_{x \varepsilon @R} [ @F(x + @h) - G(@x) ]^2)^{\frac{1}{2}}" definitions="[{&quot;replace&quot;:&quot;F(@x + @h)&quot;,&quot;symbol&quot;:&quot;F(@x + @h)&quot;,&quot;id&quot;:&quot;fxh&quot;,&quot;definition&quot;:&quot;The best translated $F(@x)$ to approximate $G(@x)$&quot;},{&quot;replace&quot;:&quot;F&#39;(@x)&quot;,&quot;symbol&quot;:&quot;F&#39;(@x)&quot;,&quot;id&quot;:&quot;fprimex&quot;,&quot;definition&quot;:&quot;Linear approximation of $F(x)$ in the neighborhood of $@x$&quot;},{&quot;replace&quot;:&quot;F(@x)&quot;,&quot;symbol&quot;:&quot;F(@x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(@x)&quot;,&quot;symbol&quot;:&quot;G(@x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;F(x)&quot;,&quot;symbol&quot;:&quot;F(x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(x)&quot;,&quot;symbol&quot;:&quot;G(x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;@h&quot;,&quot;symbol&quot;:&quot;h&quot;,&quot;id&quot;:&quot;h&quot;,&quot;definition&quot;:&quot;disparity vector&quot;},{&quot;replace&quot;:&quot;@x&quot;,&quot;symbol&quot;:&quot;x&quot;,&quot;id&quot;:&quot;x&quot;,&quot;definition&quot;:&quot;position vector in an image&quot;},{&quot;replace&quot;:&quot;@R&quot;,&quot;symbol&quot;:&quot;R&quot;,&quot;id&quot;:&quot;r&quot;,&quot;definition&quot;:&quot;Region of interest&quot;}]"></tex-math> breaks the <tex-math mode="inline" code="\frac{1}{2}" definitions="[{&quot;replace&quot;:&quot;F(@x + @h)&quot;,&quot;symbol&quot;:&quot;F(@x + @h)&quot;,&quot;id&quot;:&quot;fxh&quot;,&quot;definition&quot;:&quot;The best translated $F(@x)$ to approximate $G(@x)$&quot;},{&quot;replace&quot;:&quot;F&#39;(@x)&quot;,&quot;symbol&quot;:&quot;F&#39;(@x)&quot;,&quot;id&quot;:&quot;fprimex&quot;,&quot;definition&quot;:&quot;Linear approximation of $F(x)$ in the neighborhood of $@x$&quot;},{&quot;replace&quot;:&quot;F(@x)&quot;,&quot;symbol&quot;:&quot;F(@x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(@x)&quot;,&quot;symbol&quot;:&quot;G(@x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;F(x)&quot;,&quot;symbol&quot;:&quot;F(x)&quot;,&quot;id&quot;:&quot;fx&quot;,&quot;definition&quot;:&quot;The first stereo image&quot;},{&quot;replace&quot;:&quot;G(x)&quot;,&quot;symbol&quot;:&quot;G(x)&quot;,&quot;id&quot;:&quot;gx&quot;,&quot;definition&quot;:&quot;The second stereo image&quot;},{&quot;replace&quot;:&quot;@h&quot;,&quot;symbol&quot;:&quot;h&quot;,&quot;id&quot;:&quot;h&quot;,&quot;definition&quot;:&quot;disparity vector&quot;},{&quot;replace&quot;:&quot;@x&quot;,&quot;symbol&quot;:&quot;x&quot;,&quot;id&quot;:&quot;x&quot;,&quot;definition&quot;:&quot;position vector in an image&quot;},{&quot;replace&quot;:&quot;@R&quot;,&quot;symbol&quot;:&quot;R&quot;,&quot;id&quot;:&quot;r&quot;,&quot;definition&quot;:&quot;Region of interest&quot;}]"></tex-math>:</p><pre><code>&quot;equation with fractions L2​norm=(∑xεR​[F(x+h)−G(x)]2)21&quot;</code></pre><p>Possible solutions include serializing the equation or rendering a screenshot. Serializing a LaTeX equation requires converting it into text that is both readable and short (to get under the tweet length limit). Alternatively, we could include a rendered image of the selected text in the tweet. This preserves the structure of the equation, but isn’t ideal for searchability or accessibility.</p><h2 id="text-fragment-generation" data-counter="4.4">Text fragment generation</h2><p>It is not always possible to generate a text fragment that uniquely identifies a selection of text. In these cases, the link in the Tweet only includes the URL of the page.</p><h2 id="recent-events-at-twitter" data-counter="4.5">Recent events at Twitter</h2><p>todo: explain Twitter imploding, how does that affect academic Twitter users?</p><bibliography>@article{Barnea1972,
  title={A Class of Algorithms for Fast Digital Image Registration},
  author={Daniel I. Barnea and Harvey F. Silverman},
  journal={IEEE Transactions on Computers},
  year={1972},
  volume={C-21},
  pages={179-186},
  doi={10.1109/TC.1972.5008923}
}

@article{Marr1979,
  title={A computational theory of human stereo vision},
  author={D. Marr and Tomaso A. Poggio},
  journal={Proceedings of the Royal Society of London. Series B, Biological sciences},
  year={1979},
  volume={204 1156},
  pages={301-328},
  doi={10.1016/B978-1-4832-1446-7.50046-7}
}

@book{Dudewicz1976,
  place={New York},
  title={Introduction to statistics and probability},
  publisher={Holt, Rinehart and Winston},
  author={Dudewicz, Edward J.},
  year={1976}
}

@inproceedings{Baker1980,
  title={Edge Based Stereo Correlation},
  author={Baker, H. Harlyn},
  year={1980},
  booktitle={DARPA Image Understanding Workshop},
  pages={168-175}
}

@inproceedings{Gennery1979,
  title={Stereo-Camera Calibration},
  author={Gennery, Donald B},
  year={1979},
  booktitle={DARPA Image Understanding Workshop},
  pages={101-107}
}

@inproceedings{Moravec1979,
  title={Visual Mapping by a Robot Rover},
  author={Hans P. Moravec},
  booktitle={IJCAI},
  year={1979},
  doi={10.5555/1624861.1624997}
}

@inproceedings{Nilsson1971,
  title={Problem-solving methods in artificial intelligence},
  author={Nils J. Nilsson},
  booktitle={McGraw-Hill computer science series},
  year={1971},
  doi={10.1145/1056578.1056583}
}</bibliography></article>
    <script type="module">
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const e=window,t=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,n=Symbol(),s=new WeakMap;class o{constructor(e,t,s){if(this._$cssResult$=!0,s!==n)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const n=this.t;if(t&&void 0===e){const t=void 0!==n&&1===n.length;t&&(e=s.get(n)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),t&&s.set(n,e))}return e}toString(){return this.cssText}}const i=t?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return(e=>new o("string"==typeof e?e:e+"",void 0,n))(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var r;const a=window,u=a.trustedTypes,l=u?u.emptyScript:"",c=a.reactiveElementPolyfillSupport,h={toAttribute(e,t){switch(t){case Boolean:e=e?l:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},d=(e,t)=>t!==e&&(t==t||e==e),f={attribute:!0,type:String,converter:h,reflect:!1,hasChanged:d};class p extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;null!==(t=this.h)&&void 0!==t||(this.h=[]),this.h.push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,n)=>{const s=this._$Ep(n,t);void 0!==s&&(this._$Ev.set(s,n),e.push(s))})),e}static createProperty(e,t=f){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():"__"+e,s=this.getPropertyDescriptor(e,n,t);void 0!==s&&Object.defineProperty(this.prototype,e,s)}}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(s){const o=this[e];this[t]=s,this.requestUpdate(e,o,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||f}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const n of t)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(i(e))}else void 0!==e&&t.push(i(e));return t}static _$Ep(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,n;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(n=e.hostConnected)||void 0===n||n.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var n;const s=null!==(n=this.shadowRoot)&&void 0!==n?n:this.attachShadow(this.constructor.shadowRootOptions);return((n,s)=>{t?n.adoptedStyleSheets=s.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):s.forEach((t=>{const s=document.createElement("style"),o=e.litNonce;void 0!==o&&s.setAttribute("nonce",o),s.textContent=t.cssText,n.appendChild(s)}))})(s,this.constructor.elementStyles),s}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t,n=f){var s;const o=this.constructor._$Ep(e,n);if(void 0!==o&&!0===n.reflect){const i=(void 0!==(null===(s=n.converter)||void 0===s?void 0:s.toAttribute)?n.converter:h).toAttribute(t,n.type);this._$El=e,null==i?this.removeAttribute(o):this.setAttribute(o,i),this._$El=null}}_$AK(e,t){var n;const s=this.constructor,o=s._$Ev.get(e);if(void 0!==o&&this._$El!==o){const e=s.getPropertyOptions(o),i="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(n=e.converter)||void 0===n?void 0:n.fromAttribute)?e.converter:h;this._$El=o,this[o]=i.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,n){let s=!0;void 0!==e&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||d)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,n))):s=!1),!this.isUpdatePending&&s&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}}
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var g;p.finalized=!0,p.elementProperties=new Map,p.elementStyles=[],p.shadowRootOptions={mode:"open"},null==c||c({ReactiveElement:p}),(null!==(r=a.reactiveElementVersions)&&void 0!==r?r:a.reactiveElementVersions=[]).push("1.4.1");const m=window,v=m.trustedTypes,_=v?v.createPolicy("lit-html",{createHTML:e=>e}):void 0,b=`lit$${(Math.random()+"").slice(9)}$`,w="?"+b,E=`<${w}>`,y=document,S=(e="")=>y.createComment(e),A=e=>null===e||"object"!=typeof e&&"function"!=typeof e,x=Array.isArray,D=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,C=/-->/g,F=/>/g,O=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),N=/'/g,T=/"/g,k=/^(?:script|style|textarea|title)$/i,$=(e=>(t,...n)=>({_$litType$:e,strings:t,values:n}))(1),L=Symbol.for("lit-noChange"),R=Symbol.for("lit-nothing"),P=new WeakMap,B=y.createTreeWalker(y,129,null,!1),M=(e,t)=>{const n=e.length-1,s=[];let o,i=2===t?"<svg>":"",r=D;for(let t=0;t<n;t++){const n=e[t];let a,u,l=-1,c=0;for(;c<n.length&&(r.lastIndex=c,u=r.exec(n),null!==u);)c=r.lastIndex,r===D?"!--"===u[1]?r=C:void 0!==u[1]?r=F:void 0!==u[2]?(k.test(u[2])&&(o=RegExp("</"+u[2],"g")),r=O):void 0!==u[3]&&(r=O):r===O?">"===u[0]?(r=null!=o?o:D,l=-1):void 0===u[1]?l=-2:(l=r.lastIndex-u[2].length,a=u[1],r=void 0===u[3]?O:'"'===u[3]?T:N):r===T||r===N?r=O:r===C||r===F?r=D:(r=O,o=void 0);const h=r===O&&e[t+1].startsWith("/>")?" ":"";i+=r===D?n+E:l>=0?(s.push(a),n.slice(0,l)+"$lit$"+n.slice(l)+b+h):n+b+(-2===l?(s.push(void 0),t):h)}const a=i+(e[n]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==_?_.createHTML(a):a,s]};class H{constructor({strings:e,_$litType$:t},n){let s;this.parts=[];let o=0,i=0;const r=e.length-1,a=this.parts,[u,l]=M(e,t);if(this.el=H.createElement(u,n),B.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(s=B.nextNode())&&a.length<r;){if(1===s.nodeType){if(s.hasAttributes()){const e=[];for(const t of s.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(b)){const n=l[i++];if(e.push(t),void 0!==n){const e=s.getAttribute(n.toLowerCase()+"$lit$").split(b),t=/([.?@])?(.*)/.exec(n);a.push({type:1,index:o,name:t[2],strings:e,ctor:"."===t[1]?W:"?"===t[1]?Y:"@"===t[1]?z:q})}else a.push({type:6,index:o})}for(const t of e)s.removeAttribute(t)}if(k.test(s.tagName)){const e=s.textContent.split(b),t=e.length-1;if(t>0){s.textContent=v?v.emptyScript:"";for(let n=0;n<t;n++)s.append(e[n],S()),B.nextNode(),a.push({type:2,index:++o});s.append(e[t],S())}}}else if(8===s.nodeType)if(s.data===w)a.push({type:2,index:o});else{let e=-1;for(;-1!==(e=s.data.indexOf(b,e+1));)a.push({type:7,index:o}),e+=b.length-1}o++}}static createElement(e,t){const n=y.createElement("template");return n.innerHTML=e,n}}function I(e,t,n=e,s){var o,i,r,a;if(t===L)return t;let u=void 0!==s?null===(o=n._$Co)||void 0===o?void 0:o[s]:n._$Cl;const l=A(t)?void 0:t._$litDirective$;return(null==u?void 0:u.constructor)!==l&&(null===(i=null==u?void 0:u._$AO)||void 0===i||i.call(u,!1),void 0===l?u=void 0:(u=new l(e),u._$AT(e,n,s)),void 0!==s?(null!==(r=(a=n)._$Co)&&void 0!==r?r:a._$Co=[])[s]=u:n._$Cl=u),void 0!==u&&(t=I(e,u._$AS(e,t.values),u,s)),t}class j{constructor(e,t){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var t;const{el:{content:n},parts:s}=this._$AD,o=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:y).importNode(n,!0);B.currentNode=o;let i=B.nextNode(),r=0,a=0,u=s[0];for(;void 0!==u;){if(r===u.index){let t;2===u.type?t=new U(i,i.nextSibling,this,e):1===u.type?t=new u.ctor(i,u.name,u.strings,this,e):6===u.type&&(t=new V(i,this,e)),this.u.push(t),u=s[++a]}r!==(null==u?void 0:u.index)&&(i=B.nextNode(),r++)}return o}p(e){let t=0;for(const n of this.u)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class U{constructor(e,t,n,s){var o;this.type=2,this._$AH=R,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=s,this._$Cm=null===(o=null==s?void 0:s.isConnected)||void 0===o||o}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=I(this,e,t),A(e)?e===R||null==e||""===e?(this._$AH!==R&&this._$AR(),this._$AH=R):e!==this._$AH&&e!==L&&this.g(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>x(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.k(e):this.g(e)}O(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}g(e){this._$AH!==R&&A(this._$AH)?this._$AA.nextSibling.data=e:this.T(y.createTextNode(e)),this._$AH=e}$(e){var t;const{values:n,_$litType$:s}=e,o="number"==typeof s?this._$AC(e):(void 0===s.el&&(s.el=H.createElement(s.h,this.options)),s);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===o)this._$AH.p(n);else{const e=new j(o,this),t=e.v(this.options);e.p(n),this.T(t),this._$AH=e}}_$AC(e){let t=P.get(e.strings);return void 0===t&&P.set(e.strings,t=new H(e)),t}k(e){x(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,s=0;for(const o of e)s===t.length?t.push(n=new U(this.O(S()),this.O(S()),this,this.options)):n=t[s],n._$AI(o),s++;s<t.length&&(this._$AR(n&&n._$AB.nextSibling,s),t.length=s)}_$AR(e=this._$AA.nextSibling,t){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cm=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class q{constructor(e,t,n,s,o){this.type=1,this._$AH=R,this._$AN=void 0,this.element=e,this.name=t,this._$AM=s,this.options=o,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=R}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,n,s){const o=this.strings;let i=!1;if(void 0===o)e=I(this,e,t,0),i=!A(e)||e!==this._$AH&&e!==L,i&&(this._$AH=e);else{const s=e;let r,a;for(e=o[0],r=0;r<o.length-1;r++)a=I(this,s[n+r],t,r),a===L&&(a=this._$AH[r]),i||(i=!A(a)||a!==this._$AH[r]),a===R?e=R:e!==R&&(e+=(null!=a?a:"")+o[r+1]),this._$AH[r]=a}i&&!s&&this.j(e)}j(e){e===R?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class W extends q{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===R?void 0:e}}const X=v?v.emptyScript:"";class Y extends q{constructor(){super(...arguments),this.type=4}j(e){e&&e!==R?this.element.setAttribute(this.name,X):this.element.removeAttribute(this.name)}}class z extends q{constructor(e,t,n,s,o){super(e,t,n,s,o),this.type=5}_$AI(e,t=this){var n;if((e=null!==(n=I(this,e,t,0))&&void 0!==n?n:R)===L)return;const s=this._$AH,o=e===R&&s!==R||e.capture!==s.capture||e.once!==s.once||e.passive!==s.passive,i=e!==R&&(s===R||o);o&&this.element.removeEventListener(this.name,this,s),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==n?n:this.element,e):this._$AH.handleEvent(e)}}class V{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){I(this,e)}}const G=m.litHtmlPolyfillSupport;null==G||G(H,U),(null!==(g=m.litHtmlVersions)&&void 0!==g?g:m.litHtmlVersions=[]).push("2.4.0");const Z=(e,t,n)=>{var s,o;const i=null!==(s=null==n?void 0:n.renderBefore)&&void 0!==s?s:t;let r=i._$litPart$;if(void 0===r){const e=null!==(o=null==n?void 0:n.renderBefore)&&void 0!==o?o:null;i._$litPart$=r=new U(t.insertBefore(S(),e),e,void 0,null!=n?n:{})}return r._$AI(e),r
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */};var K,J;class Q extends p{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const n=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=n.firstChild),n}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=Z(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return L}}Q.finalized=!0,Q._$litElement$=!0,null===(K=globalThis.litElementHydrateSupport)||void 0===K||K.call(globalThis,{LitElement:Q});const ee=globalThis.litElementPolyfillSupport;null==ee||ee({LitElement:Q}),(null!==(J=globalThis.litElementVersions)&&void 0!==J?J:globalThis.litElementVersions=[]).push("3.2.2");class te extends Q{createRenderRoot(){return this}connectedCallback(){this.__initchildnodes||(this.__initchildnodes=!0,this.initialChildNodes(Array.from(this.childNodes)),function(e,t=0){const n=e.childNodes;let s=n.length;for(;s>t;)e.removeChild(n[--s])}(this)),super.connectedCallback()}initialChildNodes(e){this.__children=e}}const ne=new Map,se=[],oe=se.map,ie=se.some,re=se.hasOwnProperty,ae=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,ue=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,le=/(?:\.[^/]*|\/)$/;class ce extends Error{constructor(e){super(e)}}function he(e){const t=ae.exec(e);return t&&{name:t[1],version:t[2],path:t[3]}}function de(e="https://cdn.jsdelivr.net/npm/",t=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(e))throw new Error("origin lacks trailing slash");function n(t){const n=`${e}${t.name}${t.version?`@${t.version}`:""}/package.json`;let s=ne.get(n);return s||ne.set(n,s=fetch(n).then((e=>{if(!e.ok)throw new ce("unable to load package.json");return e.redirected&&!ne.has(e.url)&&ne.set(e.url,s),e.json()}))),s}return async function(s,o){if(s.startsWith(e)&&(s=s.substring(e.length)),/^(\w+:)|\/\//i.test(s))return s;if(/^[.]{0,2}\//i.test(s))return new URL(s,o??location).href;if(!s.length||/^[\s._]/.test(s)||/\s$/.test(s))throw new ce("illegal name");const i=he(s);if(!i)return`${e}${s}`;if(!i.version&&null!=o&&o.startsWith(e)){const t=await n(he(o.substring(e.length)));i.version=t.dependencies&&t.dependencies[i.name]||t.peerDependencies&&t.peerDependencies[i.name]}if(i.path&&!le.test(i.path)&&(i.path+=".js"),i.path&&i.version&&ue.test(i.version))return`${e}${i.name}@${i.version}/${i.path}`;const r=await n(i);return`${e}${r.name}@${r.version}/${i.path||function(e){for(const n of t){let t=e[n];if("string"==typeof t)return t.startsWith("./")&&(t=t.slice(2)),le.test(t)?t:`${t}.js`}}(r)||"index.js"}`}}ce.prototype.name=ce.name;var fe=pe(de());function pe(e){const t=new Map,n=o(null);function s(e){if("string"!=typeof e)return e;let n=t.get(e);return n||t.set(e,n=new Promise(((t,n)=>{const s=document.createElement("script");s.onload=()=>{try{t(se.pop()(o(e)))}catch(e){n(new ce("invalid module"))}s.remove()},s.onerror=()=>{n(new ce("unable to load module")),s.remove()},s.async=!0,s.src=e,window.define=_e,document.head.appendChild(s)}))),n}function o(t){return n=>Promise.resolve(e(n,t)).then(s)}function i(e){return arguments.length>1?Promise.all(oe.call(arguments,n)).then(ge):n(e)}return i.alias=function(t){return pe(((n,s)=>n in t&&(s=null,"string"!=typeof(n=t[n]))?n:e(n,s)))},i.resolve=e,i}function ge(e){const t={};for(const n of e)for(const e in n)re.call(n,e)&&(null==n[e]?Object.defineProperty(t,e,{get:me(n,e)}):t[e]=n[e]);return t}function me(e,t){return()=>e[t]}function ve(e){return"exports"===(e+="")||"module"===e}function _e(e,t,n){const s=arguments.length;s<2?(n=e,t=[]):s<3&&(n=t,t="string"==typeof e?[]:e),se.push(ie.call(t,ve)?e=>{const s={},o={exports:s};return Promise.all(oe.call(t,(t=>"exports"===(t+="")?s:"module"===t?o:e(t)))).then((e=>(n.apply(null,e),o.exports)))}:e=>Promise.all(oe.call(t,e)).then((e=>"function"==typeof n?n.apply(null,e):n)))}_e.amd={};const be=Symbol("dependencies"),we=Symbol("load"),Ee=Promise.resolve(!0),ye=new Map;function Se(e){let t="undefined"!=typeof HTMLElement&&e instanceof HTMLElement?e.constructor:e;for(;t&&!Object.hasOwn(t,"dependencies");)if(t=Object.getPrototypeOf(t),t&&"HTMLElement"===t.name)return null;return t}function Ae(e){const t=Se(e);if(!t)return Ee;const n=t[be]||(t[be]={});if(n[we])return n[we];const s={main:[],css:[]},o=t.dependencies;return o.forEach((({name:t,version:n,main:o,css:i})=>{const r=function(e,t){return n=>`https://cdn.jsdelivr.net/npm/${e}@${t}/${n}`}(t,n),a=r(o),u=r(i),l=ye.get(a)||fe(a);ye.set(a,l),s.main.push(l),i&&!ye.has(u)&&(ye.set(u,!0),s.css.push(function(e,t=globalThis.document){return new Promise((function(n,s){const o=t.createElement("link");o.rel="stylesheet",o.href=e,o.onerror=s,o.onload=n,t.head.appendChild(o)}))}(u,e.ownerDocument)))})),n[we]=Promise.all(s.main.concat(s.css)).then((e=>{const n=o.reduce(((t,n,s)=>(t[n.name]=e[s],t)),{});!function(e,t){const n=Se(e);if(n){const e=n[be]||(n[be]={});for(const n in t)e[n]=t[n];e[we]=Ee}}(t,n)}))}class xe extends te{getDependency(e){return function(e,t){return Se(e)?.[be]?.[t]}(this,e)}shouldUpdate(){return!!function(e){const t=Se(e);return!t||t[be]?.[we]===Ee}(this)||(Ae(this).then((()=>{this.requestUpdate()})),!1)}}function De(e,t,n){const s=t.getBoundingClientRect(),o=e.getBoundingClientRect(),i=document.createElementNS("http://www.w3.org/2000/svg","svg"),r=document.createElementNS("http://www.w3.org/2000/svg","line"),a=document.createElementNS("http://www.w3.org/2000/svg","circle");return a.setAttribute("cx",e.offsetWidth/2),a.setAttribute("cy",o.y-s.y-e.offsetHeight),a.setAttribute("r",2),r.setAttribute("stroke","black"),r.setAttribute("stroke-width","1px"),r.setAttribute("x1",e.offsetWidth/2),r.setAttribute("y1",o.y-s.y-e.offsetHeight),r.setAttribute("x2",s.x-o.x+t.offsetWidth/2),r.setAttribute("y2",n?6:4),i.setAttribute("style",`display:inline-block;position:absolute;\n    transform:translate(-${s.x-o.x+t.offsetWidth-4}px,\n    ${o.y-s.y-t.offsetHeight/2}px);\n    width:${s.x-o.x+t.offsetWidth}px;\n    height:${o.y-s.y-e.offsetHeight+3}px;`),i.appendChild(r),i.appendChild(a),i}function Ce(e){let t=[...e.querySelectorAll(".sticky")].map((t=>({sticky:t,inMargin:t.classList.contains("margin"),end:e.querySelector(t.getAttribute("sticky-through"))||e.querySelector(t.getAttribute("sticky-until")),untilBottom:null!=t.getAttribute("sticky-through")})));for(const{sticky:e}of t.filter((({end:e})=>!e)))console.log(e,"Could not find sticky anchor "+(e.getAttribute("sticky-through")||e.getAttribute("sticky-until"))),e.classList.remove("sticky");t=t.filter((({end:e})=>e));const n=[],s=[];for(const e of document.querySelectorAll("table-of-contents a")){const t=document.getElementById(e.hash.slice(1));if(t){const o=[e.parentNode];let i;do{if(i=o[o.length-1].parentNode.closest("li"),!i)break;o.push(i)}while(i);e.parents=o,n.push(e),s.push(t)}else e.outerHTML=e.innerHTML}s.reverse();let o=-1,i=null;window.addEventListener("scroll",(()=>{!function(){let e=[];const n=!window.matchMedia("(max-width: 1100px)").matches;for(const{sticky:s,inMargin:o,end:i,untilBottom:r}of t){if(!i)continue;const t=s.getBoundingClientRect(),a=t.top+window.scrollY-+s.style.transform.slice("translateY(".length,-"px)".length);let u=i.offsetTop;r&&(u+=i.offsetHeight);let l=u-(a+t.height);l=Math.min(0,l);let c=a+l,h=c+t.height;for(const[i,r,d]of e){if(n&&o!=d||h<=i||c>=r)continue;let e=Math.max(0,r+t.height-u);l=r-a-e,c=r-e,h=c+t.height,s.style.setProperty("z-index",1)}e.push([c,h,o]),s.style.setProperty("transform",`translateY(${l}px)`)}}(),function(){const e=s.length-s.findIndex((e=>window.scrollY>=e.offsetTop-10))-1;if(e!==o){if(i){i.classList.remove("active");for(const e of document.querySelectorAll(".active-parent"))e.classList.remove("active-parent")}if(o=e,n[e]){i=n[e].parentElement,i.classList.add("active");for(const t of n[e].parents)t.classList.add("active-parent")}}}()}),{passive:!0})}const{getPrototypeOf:Fe,getOwnPropertyDescriptors:Oe}=Object;Fe({});var Ne={},Te={};function ke(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function $e(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var s in e)s in t||n.push(t[s]=s)})),n}function Le(e,t){var n=e+"",s=n.length;return s<t?new Array(t-s+1).join(0)+n:n}function Re(e){var t,n=e.getUTCHours(),s=e.getUTCMinutes(),o=e.getUTCSeconds(),i=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+Le(-t,6):t>9999?"+"+Le(t,6):Le(t,4))+"-"+Le(e.getUTCMonth()+1,2)+"-"+Le(e.getUTCDate(),2)+(i?"T"+Le(n,2)+":"+Le(s,2)+":"+Le(o,2)+"."+Le(i,3)+"Z":o?"T"+Le(n,2)+":"+Le(s,2)+":"+Le(o,2)+"Z":s||n?"T"+Le(n,2)+":"+Le(s,2)+"Z":"")}function Pe(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function s(e,t){var s,o=[],i=e.length,r=0,a=0,u=i<=0,l=!1;function c(){if(u)return Te;if(l)return l=!1,Ne;var t,s,o=r;if(34===e.charCodeAt(o)){for(;r++<i&&34!==e.charCodeAt(r)||34===e.charCodeAt(++r););return(t=r)>=i?u=!0:10===(s=e.charCodeAt(r++))?l=!0:13===s&&(l=!0,10===e.charCodeAt(r)&&++r),e.slice(o+1,t-1).replace(/""/g,'"')}for(;r<i;){if(10===(s=e.charCodeAt(t=r++)))l=!0;else if(13===s)l=!0,10===e.charCodeAt(r)&&++r;else if(s!==n)continue;return e.slice(o,t)}return u=!0,e.slice(o,i)}for(10===e.charCodeAt(i-1)&&--i,13===e.charCodeAt(i-1)&&--i;(s=c())!==Te;){for(var h=[];s!==Ne&&s!==Te;)h.push(s),s=c();t&&null==(h=t(h,a++))||o.push(h)}return o}function o(t,n){return t.map((function(t){return n.map((function(e){return r(t[e])})).join(e)}))}function i(t){return t.map(r).join(e)}function r(e){return null==e?"":e instanceof Date?Re(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,o,i=s(e,(function(e,s){if(n)return n(e,s-1);o=e,n=t?function(e,t){var n=ke(e);return function(s,o){return t(n(s),o,e)}}(e,t):ke(e)}));return i.columns=o||[],i},parseRows:s,format:function(t,n){return null==n&&(n=$e(t)),[n.map(r).join(e)].concat(o(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=$e(e)),o(e,t).join("\n")},formatRows:function(e){return e.map(i).join("\n")},formatRow:i,formatValue:r}}var Be=Pe(","),Me=Be.parse,He=Be.parseRows,Ie=Pe("\t"),je=Ie.parse,Ue=Ie.parseRows;function qe(e){for(var t in e){var n,s,o=e[t].trim();if(o)if("true"===o)o=!0;else if("false"===o)o=!1;else if("NaN"===o)o=NaN;else if(isNaN(n=+o)){if(!(s=o.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;We&&s[4]&&!s[7]&&(o=o.replace(/-/g,"/").replace(/T/," ")),o=new Date(o)}else o=n;else o=null;e[t]=o}return e}const We=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function Xe(e,t,n){return{resolve:(s=n)=>`${e}@${t}/${s}`}}const Ye=Xe("d3","7.6.1","dist/d3.min.js"),ze=Xe("@observablehq/inputs","0.10.4","dist/inputs.min.js"),Ve=Xe("@observablehq/plot","0.6.0","dist/plot.umd.min.js"),Ge=Xe("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),Ze=Xe("@observablehq/highlight.js","2.0.0","highlight.min.js"),Ke=Xe("@observablehq/katex","0.11.1","dist/katex.min.js"),Je=Xe("lodash","4.17.21","lodash.min.js"),Qe=Xe("htl","0.3.1","dist/htl.min.js"),et=Xe("jszip","3.10.0","dist/jszip.min.js"),tt=Xe("marked","0.3.12","marked.min.js"),nt=Xe("sql.js","1.7.0","dist/sql-wasm.js"),st=Xe("vega","5.22.1","build/vega.min.js"),ot=Xe("vega-lite","5.5.0","build/vega-lite.min.js"),it=Xe("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),rt=Xe("apache-arrow","4.0.1","Arrow.es2015.min.js"),at=Xe("arquero","4.8.8","dist/arquero.min.js"),ut=Xe("topojson-client","3.1.0","dist/topojson-client.min.js"),lt=Xe("exceljs","4.3.0","dist/exceljs.min.js"),ct=Xe("mermaid","9.1.6","dist/mermaid.min.js"),ht=Xe("leaflet","1.8.0","dist/leaflet.js");let dt=fe;async function ft(e){const[t,n]=await Promise.all([e(nt.resolve()),e.resolve(nt.resolve("dist/"))]);return t({locateFile:e=>`${n}${e}`})}class pt{constructor(e){Object.defineProperties(this,{_db:{value:e}})}static async open(e){const[t,n]=await Promise.all([ft(dt),Promise.resolve(e).then(mt)]);return new pt(new t.Database(n))}async query(e,t){return await async function(e,t,n){const[s]=await e.exec(t,n);if(!s)return[];const{columns:o,values:i}=s,r=i.map((e=>Object.fromEntries(e.map(((e,t)=>[o[t],e])))));return r.columns=o,r}(this._db,e,t)}async queryRow(e,t){return(await this.query(e,t))[0]||null}async explain(e,t){return vt("pre",{className:"observablehq--inspect"},[_t((await this.query(`EXPLAIN QUERY PLAN ${e}`,t)).map((e=>e.detail)).join("\n"))])}async describeTables({schema:e}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${null==e?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%'`,null==e?[]:[e])}async describeColumns({schema:e,table:t}={}){if(null==t)throw new Error("missing table");const n=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${null==e?"":", ?"}) ORDER BY cid`,null==e?[t]:[t,e]);if(!n.length)throw new Error(`table not found: ${t}`);return n.map((({name:e,type:t,notnull:n})=>({name:e,type:gt(t),databaseType:t,nullable:!n})))}async describe(e){const t=await(void 0===e?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[e]));if(!t.length)throw new Error("Not found");const{columns:n}=t;return vt("table",{value:t},[vt("thead",[vt("tr",n.map((e=>vt("th",[_t(e)]))))]),vt("tbody",t.map((e=>vt("tr",n.map((t=>vt("td",[_t(e[t])])))))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(e,...t){return[e.join("?"),t]}}function gt(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":case"DATE":case"DATETIME":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function mt(e){return"string"==typeof e?fetch(e).then(mt):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(mt):e instanceof ArrayBuffer?new Uint8Array(e):e}function vt(e,t,n){2===arguments.length&&(n=t,t=void 0);const s=document.createElement(e);if(void 0!==t)for(const e in t)s[e]=t[e];if(void 0!==n)for(const e of n)s.appendChild(e);return s}function _t(e){return document.createTextNode(e)}Object.defineProperty(pt.prototype,"dialect",{value:"sqlite"});class bt{constructor(e){Object.defineProperties(this,{_:{value:e},sheetNames:{value:e.worksheets.map((e=>e.name)),enumerable:!0}})}sheet(e,t){const n="number"==typeof e?this.sheetNames[e]:this.sheetNames.includes(e+="")?e:null;if(null==n)throw new Error(`Sheet not found: ${e}`);return function(e,{range:t,headers:n}={}){let[[s,o],[i,r]]=function(e=":",{columnCount:t,rowCount:n}){if(!(e+="").match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[s=0,o=0],[i=t-1,r=n-1]]=e.split(":").map(St);return[[s,o],[i,r]]}(t,e);const a=n?e._rows[o++]:null;let u=new Set(["#"]);for(let e=s;e<=i;e++){const t=a?wt(a.findCell(e+1)):null;let n=t&&t+""||yt(e);for(;u.has(n);)n+="_";u.add(n)}u=new Array(s).concat(Array.from(u));const l=new Array(r-o+1);for(let t=o;t<=r;t++){const n=l[t-o]=Object.create(null,{"#":{value:t+1}}),r=e.getRow(t+1);if(r.hasValues)for(let e=s;e<=i;e++){const t=wt(r.findCell(e+1));null!=t&&(n[u[e+1]]=t)}}return l.columns=u.filter((()=>!0)),l}(this._.getWorksheet(n),t)}}function wt(e){if(!e)return;const{value:t}=e;if(t&&"object"==typeof t&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return Et(t);if(t.text){let{text:e}=t;return e.richText&&(e=Et(e)),t.hyperlink&&t.hyperlink!==e?`${t.hyperlink} ${e}`:e}return t}return t}function Et(e){return e.richText.map((e=>e.text)).join("")}function yt(e){let t="";e++;do{t=String.fromCharCode(64+(e%26||26))+t}while(e=Math.floor((e-1)/26));return t}function St(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let s=0;if(t)for(let e=0;e<t.length;e++)s+=Math.pow(26,t.length-e-1)*(t.charCodeAt(e)-64);return[s?s-1:void 0,n?+n-1:void 0]}async function At(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}async function xt(e,t,{array:n=!1,typed:s=!1}={}){const o=await e.text();return("\t"===t?n?Ue:je:n?He:Me)(o,s&&qe)}class Dt{constructor(e,t){Object.defineProperty(this,"name",{value:e,enumerable:!0}),void 0!==t&&Object.defineProperty(this,"mimeType",{value:t+"",enumerable:!0})}async blob(){return(await At(this)).blob()}async arrayBuffer(){return(await At(this)).arrayBuffer()}async text(){return(await At(this)).text()}async json(){return(await At(this)).json()}async stream(){return(await At(this)).body}async csv(e){return xt(this,",",e)}async tsv(e){return xt(this,"\t",e)}async image(e){const t=await this.url();return new Promise(((n,s)=>{const o=new Image;new URL(t,document.baseURI).origin!==new URL(location).origin&&(o.crossOrigin="anonymous"),Object.assign(o,e),o.onload=()=>n(o),o.onerror=()=>s(new Error(`Unable to load file: ${this.name}`)),o.src=t}))}async arrow(){const[e,t]=await Promise.all([dt(rt.resolve()),At(this)]);return e.Table.from(t)}async sqlite(){return pt.open(At(this))}async zip(){const[e,t]=await Promise.all([dt(et.resolve()),this.arrayBuffer()]);return new Ot(await e.loadAsync(t))}async xml(e="application/xml"){return(new DOMParser).parseFromString(await this.text(),e)}async html(){return this.xml("text/html")}async xlsx(){const[e,t]=await Promise.all([dt(lt.resolve()),this.arrayBuffer()]);return new bt(await(new e.Workbook).xlsx.load(t))}}class Ct extends Dt{constructor(e,t,n){super(t,n),Object.defineProperty(this,"_url",{value:e})}async url(){return await this._url+""}}function Ft(e){throw new Error(`File not found: ${e}`)}class Ot{constructor(e){Object.defineProperty(this,"_",{value:e}),this.filenames=Object.keys(e.files).filter((t=>!e.files[t].dir))}file(e){const t=this._.file(e+="");if(!t||t.dir)throw new Error(`file not found: ${e}`);return new Nt(t)}}class Nt extends Dt{constructor(e){super(e.name),Object.defineProperty(this,"_",{value:e}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}var Tt={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var kt=0;function $t(e){return new Lt("O-"+(null==e?"":e+"-")+ ++kt)}function Lt(e){this.id=e,this.href=new URL(`#${e}`,location)+""}Lt.prototype.toString=function(){return"url("+this.href+")"};var Rt={canvas:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n},context2d:function(e,t,n){null==n&&(n=devicePixelRatio);var s=document.createElement("canvas");s.width=e*n,s.height=t*n,s.style.width=e+"px";var o=s.getContext("2d");return o.scale(n,n),o},download:function(e,t="untitled",n="Save"){const s=document.createElement("a"),o=s.appendChild(document.createElement("button"));async function i(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(s.href),s.removeAttribute("href"),o.textContent=n,o.disabled=!1}return o.textContent=n,s.download=t,s.onclick=async t=>{if(o.disabled=!0,s.href)return i();o.textContent="Saving…";try{const t=await("function"==typeof e?e():e);o.textContent="Download",s.href=URL.createObjectURL(t)}catch(e){o.textContent=n}if(t.eventPhase)return i();o.disabled=!1},s},element:function(e,t){var n,s=e+="",o=s.indexOf(":");o>=0&&"xmlns"!==(s=e.slice(0,o))&&(e=e.slice(o+1));var i=Tt.hasOwnProperty(s)?document.createElementNS(Tt[s],e):document.createElement(e);if(t)for(var r in t)o=(s=r).indexOf(":"),n=t[r],o>=0&&"xmlns"!==(s=r.slice(0,o))&&(r=r.slice(o+1)),Tt.hasOwnProperty(s)?i.setAttributeNS(Tt[s],r,n):i.setAttribute(r,n);return i},input:function(e){var t=document.createElement("input");return null!=e&&(t.type=e),t},range:function(e,t,n){1===arguments.length&&(t=e,e=null);var s=document.createElement("input");return s.min=e=null==e?0:+e,s.max=t=null==t?1:+t,s.step=null==n?"any":n=+n,s.type="range",s},select:function(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,(function(e){var n=document.createElement("option");n.value=n.textContent=e,t.appendChild(n)})),t},svg:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n},text:function(e){return document.createTextNode(e)},uid:$t};var Pt={buffer:function(e){return new Promise((function(t,n){var s=new FileReader;s.onload=function(){t(s.result)},s.onerror=n,s.readAsArrayBuffer(e)}))},text:function(e){return new Promise((function(t,n){var s=new FileReader;s.onload=function(){t(s.result)},s.onerror=n,s.readAsText(e)}))},url:function(e){return new Promise((function(t,n){var s=new FileReader;s.onload=function(){t(s.result)},s.onerror=n,s.readAsDataURL(e)}))}};function Bt(){return this}function Mt(e,t){let n=!1;if("function"!=typeof t)throw new Error("dispose is not a function");return{[Symbol.iterator]:Bt,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}function Ht(e){let t,n,s=!1;const o=e((function(e){n?(n(e),n=null):s=!0;return t=e}));if(null!=o&&"function"!=typeof o)throw new Error("function"==typeof o.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Bt,throw:()=>({done:!0}),return:()=>(null!=o&&o(),{done:!0}),next:function(){return{done:!1,value:s?(s=!1,Promise.resolve(t)):new Promise((e=>n=e))}}}}function It(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,(e=>e.value));default:return e.value}}var jt={disposable:Mt,filter:function*(e,t){for(var n,s=-1;!(n=e.next()).done;)t(n.value,++s)&&(yield n.value)},input:function(e){return Ht((function(t){var n=function(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}(e),s=It(e);function o(){t(It(e))}return e.addEventListener(n,o),void 0!==s&&t(s),function(){e.removeEventListener(n,o)}}))},map:function*(e,t){for(var n,s=-1;!(n=e.next()).done;)yield t(n.value,++s)},observe:Ht,queue:function(e){let t;const n=[],s=e((function(e){n.push(e),t&&(t(n.shift()),t=null);return e}));if(null!=s&&"function"!=typeof s)throw new Error("function"==typeof s.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Bt,throw:()=>({done:!0}),return:()=>(null!=s&&s(),{done:!0}),next:function(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise((e=>t=e))}}}},range:function*(e,t,n){e=+e,t=+t,n=(o=arguments.length)<2?(t=e,e=0,1):o<3?1:+n;for(var s=-1,o=0|Math.max(0,Math.ceil((t-e)/n));++s<o;)yield e+s*n},valueAt:function(e,t){if(!(!isFinite(t=+t)||t<0||t!=t|0))for(var n,s=-1;!(n=e.next()).done;)if(++s===t)return n.value},worker:function(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return Mt(n,(()=>{n.terminate(),URL.revokeObjectURL(t)}))}};function Ut(e,t){return function(n){var s,o,i,r,a,u,l,c,h=n[0],d=[],f=null,p=-1;for(a=1,u=arguments.length;a<u;++a){if((s=arguments[a])instanceof Node)d[++p]=s,h+="\x3c!--o:"+p+"--\x3e";else if(Array.isArray(s)){for(l=0,c=s.length;l<c;++l)(o=s[l])instanceof Node?(null===f&&(d[++p]=f=document.createDocumentFragment(),h+="\x3c!--o:"+p+"--\x3e"),f.appendChild(o)):(f=null,h+=o);f=null}else h+=s;h+=n[a]}if(f=e(h),++p>0){for(i=new Array(p),r=document.createTreeWalker(f,NodeFilter.SHOW_COMMENT,null,!1);r.nextNode();)o=r.currentNode,/^o:/.test(o.nodeValue)&&(i[+o.nodeValue.slice(2)]=o);for(a=0;a<p;++a)(o=i[a])&&o.parentNode.replaceChild(d[a],o)}return 1===f.childNodes.length?f.removeChild(f.firstChild):11===f.nodeType?((o=t()).appendChild(f),o):f}}var qt=Ut((function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)}),(function(){return document.createElement("span")}));function Wt(e){let t;Object.defineProperties(this,{generator:{value:Ht((e=>{t=e}))},value:{get:()=>e,set:n=>t(e=n)}}),void 0!==e&&t(e)}function*Xt(){for(;;)yield Date.now()}var Yt=new Map;function zt(e,t){var n;return(n=Yt.get(e=+e))?n.then((()=>t)):(n=Date.now())>=e?Promise.resolve(t):function(e,t){var n=new Promise((function(n){Yt.delete(t);var s=t-e;if(!(s>0))throw new Error("invalid time");if(s>2147483647)throw new Error("too long to wait");setTimeout(n,s)}));return Yt.set(t,n),n}(n,e).then((()=>t))}var Vt={delay:function(e,t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))},tick:function(e,t){return zt(Math.ceil((Date.now()+1)/e)*e,t)},when:zt};function Gt(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,t??location).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}var Zt=Ut((function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t}),(function(){return document.createElementNS("http://www.w3.org/2000/svg","g")})),Kt=String.raw;function Jt(e){return new Promise((function(t,n){var s=document.createElement("link");s.rel="stylesheet",s.href=e,s.onerror=n,s.onload=t,document.head.appendChild(s)}))}function Qt(){return Ht((function(e){var t=e(document.body.clientWidth);function n(){var n=document.body.clientWidth;n!==t&&e(t=n)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}))}const en=Object.assign((async(e,t,n)=>{const s=function(e,t){const n=t&&"function"==typeof t.escape?t.escape:e=>e,{select:s,from:o,filter:i,sort:r,slice:a}=e;if(null===o.table||null===s.columns||s.columns&&0===s.columns.length)return;const u=s.columns.map((e=>`t.${n(e)}`)),l=[[`SELECT ${u} FROM ${nn(o.table,n)} t`]];for(let e=0;e<i.length;++e)sn(e?"\nAND ":"\nWHERE ",l),rn(i[e],l);for(let e=0;e<r.length;++e)sn(e?", ":"\nORDER BY ",l),on(r[e],l);null===a.to&&null===a.from||sn("\nLIMIT "+(null!==a.to?a.to-(a.from||0):1e9),l);null!==a.from&&sn(` OFFSET ${a.from}`,l);return l}(t,await e);return s?tn(await e,s,n):null}),{sql:(e,t)=>async function(){return tn(e,arguments,t)}});async function tn(e,t,n){if(e){if("function"==typeof e.queryTag){const s=new AbortController,o={signal:s.signal};if(n.then((()=>s.abort("invalidated"))),"function"==typeof e.queryStream)return async function*(e){const t=await e,n=[];n.done=!1,n.error=null,n.schema=t.schema;try{const e=t.readRows();do{const t=await e.next();if(t.done)n.done=!0;else for(const e of t.value)n.push(e);yield n}while(!n.done)}catch(e){n.error=e,yield n}}(e.queryStream(...e.queryTag.apply(e,t),o));if("function"==typeof e.query)return e.query(...e.queryTag.apply(e,t),o)}if("function"==typeof e.sql)return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}}function nn(e,t){if("object"==typeof e){let n="";return null!=e.database&&(n+=t(e.database)+"."),null!=e.schema&&(n+=t(e.schema)+"."),n+=t(e.table),n}return e}function sn(e,t){const n=t[0];n[n.length-1]+=e}function on({column:e,direction:t},n){sn(`t.${e} ${t.toUpperCase()}`,n)}function rn({type:e,operands:t},n){if(t.length<1)throw new Error("Invalid operand length");if(1===t.length)switch(an(t[0],n),e){case"n":return void sn(" IS NULL",n);case"nn":return void sn(" IS NOT NULL",n);default:throw new Error("Invalid filter operation")}if(2!==t.length||["in","nin"].includes(e)){var s;switch(an(t[0],n),e){case"in":sn(" IN (",n);break;case"nin":sn(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}!function(e,t){let n=!0;for(const s of e)n?n=!1:sn(",",t),t.push(s.value),t[0].push("")}(t.slice(1),n),sn(")",n)}else{if(["c","nc"].includes(e)){switch(an(t[0],n),e){case"c":sn(" LIKE ",n);break;case"nc":sn(" NOT LIKE ",n)}return void an((s=t[1],{...s,value:`%${s.value}%`}),n)}switch(an(t[0],n),e){case"eq":sn(" = ",n);break;case"ne":sn(" <> ",n);break;case"gt":sn(" > ",n);break;case"lt":sn(" < ",n);break;case"gte":sn(" >= ",n);break;case"lte":sn(" <= ",n);break;default:throw new Error("Invalid filter operation")}an(t[1],n)}}function an(e,t){"column"===e.type?sn(`t.${e.value}`,t):(t.push(e.value),t[0].push(""))}var un=Object.assign(Object.defineProperties((function(e){const t=function(e){return null==e?dt:pe(e)}(e);var n;Object.defineProperties(this,(n={FileAttachment:()=>Ft,Mutable:()=>Wt,now:Xt,width:Qt,dot:()=>t(Ge.resolve()),htl:()=>t(Qe.resolve()),html:()=>qt,md:()=>function(e){return e(tt.resolve()).then((function(t){return Ut((function(n){var s=document.createElement("div");s.innerHTML=t(n,{langPrefix:""}).trim();var o=s.querySelectorAll("pre code[class]");return o.length>0&&e(Ze.resolve()).then((function(t){o.forEach((function(n){function s(){t.highlightBlock(n),n.parentNode.classList.add("observablehq--md-pre")}t.getLanguage(n.className)?s():e(Ze.resolve("async-languages/index.js")).then((s=>{if(s.has(n.className))return e(Ze.resolve("async-languages/"+s.get(n.className))).then((e=>{t.registerLanguage(n.className,e)}))})).then(s,s)}))})),s}),(function(){return document.createElement("div")}))}))}(t),svg:()=>Zt,tex:()=>function(e){return Promise.all([e(Ke.resolve()),e.resolve(Ke.resolve("dist/katex.min.css")).then(Jt)]).then((function(e){var t=e[0],n=s();function s(e){return function(){var n=document.createElement("div");return t.render(Kt.apply(String,arguments),n,e),n.removeChild(n.firstChild)}}return n.options=s,n.block=s({displayMode:!0}),n}))}(t),_:()=>t(Je.resolve()),aq:()=>t.alias({"apache-arrow":rt.resolve()})(at.resolve()),Arrow:()=>t(rt.resolve()),d3:()=>t(Ye.resolve()),Inputs:()=>t(ze.resolve()).then((e=>({...e,file:e.fileOf(Dt)}))),L:()=>async function(e){const t=await e(ht.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(ht.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}(t),mermaid:()=>async function(e){const t=await e(ct.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const e=document.createElement("div");return e.innerHTML=t.render($t().id,String.raw.apply(String,arguments)),e.removeChild(e.firstChild)}}(t),Plot:()=>t(Ve.resolve()),__query:()=>en,require:()=>t,resolve:()=>Gt,SQLite:()=>ft(t),SQLiteDatabaseClient:()=>pt,topojson:()=>t(ut.resolve()),vl:()=>async function(e){const[t,n,s]=await Promise.all([st,ot,it].map((t=>e(t.resolve()))));return s.register(t,n)}(t),aapl:()=>new Ct("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new Ct("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new Ct("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new Ct("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new Ct("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new Ct("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new Ct("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new Ct("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new Ct("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new Ct("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),weather:()=>new Ct("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:Rt,Files:Pt,Generators:jt,Promises:Vt},Object.fromEntries(Object.entries(n).map(ln))))}),{resolve:{get:()=>dt.resolve,enumerable:!0,configurable:!0},require:{get:()=>dt,set:function(e){dt=e},enumerable:!0,configurable:!0}}),{resolveFrom:de,requireFrom:pe});function ln([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}function cn(e,t){this.message=e+"",this.input=t}function hn(e){return function(){return e}}function dn(e){return e}cn.prototype=Object.create(Error.prototype),cn.prototype.name="RuntimeError",cn.prototype.constructor=cn;var fn=Array.prototype.map;function pn(){}var gn={};function mn(e,t,n){var s;n||(n=gn),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:bn,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:pn,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==gn,writable:!0},_rejector:{value:(s=this,function(e){if(e===wn)throw e;if(e===bn)throw new cn(s._name+" is not defined",s._name);if(e instanceof Error&&e.message)throw new cn(e.message,s._name);throw new cn(s._name+" could not be resolved",s._name)})},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}function vn(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function _n(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function bn(){throw bn}function wn(){throw wn}function En(e){return function(){throw new cn(e+" is defined more than once")}}function yn(e,t,n){var s=this._module._scope,o=this._module._runtime;if(this._inputs.forEach(_n,this),t.forEach(vn,this),this._inputs=t,this._definition=n,this._value=void 0,n===pn?o._variables.delete(this):o._variables.add(this),e!==this._name||s.get(e)!==this){var i,r;if(this._name)if(this._outputs.size)s.delete(this._name),(r=this._module._resolve(this._name))._outputs=this._outputs,this._outputs=new Set,r._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(this)]=r}),this),r._outputs.forEach(o._updates.add,o._updates),o._dirty.add(r).add(this),s.set(this._name,r);else if((r=s.get(this._name))===this)s.delete(this._name);else{if(3!==r._type)throw new Error;r._duplicates.delete(this),this._duplicate=void 0,1===r._duplicates.size&&(r=r._duplicates.keys().next().value,i=s.get(this._name),r._outputs=i._outputs,i._outputs=new Set,r._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(i)]=r})),r._definition=r._duplicate,r._duplicate=void 0,o._dirty.add(i).add(r),o._updates.add(r),s.set(this._name,r))}if(this._outputs.size)throw new Error;e&&((r=s.get(e))?3===r._type?(this._definition=En(e),this._duplicate=n,r._duplicates.add(this)):2===r._type?(this._outputs=r._outputs,r._outputs=new Set,this._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(r)]=this}),this),o._dirty.add(r).add(this),s.set(e,this)):(r._duplicate=r._definition,this._duplicate=n,(i=new mn(3,this._module))._name=e,i._definition=this._definition=r._definition=En(e),i._outputs=r._outputs,r._outputs=new Set,i._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(r)]=i})),i._duplicates=new Set([this,r]),o._dirty.add(r).add(i),o._updates.add(r).add(i),s.set(e,i)):s.set(e,this)),this._name=e}return this._version>0&&++this._version,o._updates.add(this),o._compute(),this}function Sn(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",Cn],["invalidation",Fn],["visibility",On],...t])},_source:{value:null,writable:!0}})}async function An(e,t){await e._compute();try{return await t._promise}catch(n){if(n===wn)return An(e,t);throw n}}function xn(e){return e._name}Object.defineProperties(mn.prototype,{_pending:{value:function(){this._observer.pending&&this._observer.pending()},writable:!0,configurable:!0},_fulfilled:{value:function(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)},writable:!0,configurable:!0},_rejected:{value:function(e){this._observer.rejected&&this._observer.rejected(e,this._name)},writable:!0,configurable:!0},define:{value:function(e,t,n){switch(arguments.length){case 1:n=e,e=t=null;break;case 2:n=t,"string"==typeof e?t=null:(t=e,e=null)}return yn.call(this,null==e?null:e+"",null==t?[]:fn.call(t,this._module._resolve,this._module),"function"==typeof n?n:hn(n))},writable:!0,configurable:!0},delete:{value:function(){return yn.call(this,null,[],pn)},writable:!0,configurable:!0},import:{value:function(e,t,n){arguments.length<3&&(n=t,t=e);return yn.call(this,t+"",[n._resolve(e+"")],dn)},writable:!0,configurable:!0}}),Object.defineProperties(Sn.prototype,{_resolve:{value:function(e){var t,n=this._scope.get(e);if(!n)if(n=new mn(2,this),this._builtins.has(e))n.define(e,hn(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))n.import(e,this._runtime._builtin);else{try{t=this._runtime._global(e)}catch(t){return n.define(e,function(e){return function(){throw e}}(t))}void 0===t?this._scope.set(n._name=e,n):n.define(e,hn(t))}return n},writable:!0,configurable:!0},redefine:{value:function(e){var t=this._scope.get(e);if(!t)throw new cn(e+" is not defined");if(3===t._type)throw new cn(e+" is defined more than once");return t.define.apply(t,arguments)},writable:!0,configurable:!0},define:{value:function(){var e=new mn(1,this);return e.define.apply(e,arguments)},writable:!0,configurable:!0},derive:{value:function(e,t){const n=new Map,s=new Set,o=[];function i(e){let t=n.get(e);return t||(t=new Sn(e._runtime,e._builtins),t._source=e,n.set(e,t),o.push([t,e]),s.add(e),t)}const r=i(this);for(const n of e){const{alias:e,name:s}="object"==typeof n?n:{name:n};r.import(s,e??s,t)}for(const e of s)for(const[t,n]of e._scope)if(n._definition===dn){if(e===this&&r._scope.has(t))continue;const s=n._inputs[0]._module;s._source&&i(s)}for(const[e,t]of o)for(const[s,o]of t._scope){const t=e._scope.get(s);if(!t||2===t._type)if(o._definition===dn){const t=o._inputs[0],i=t._module;e.import(t._name,s,n.get(i)||i)}else e.define(s,o._inputs.map(xn),o._definition)}return r},writable:!0,configurable:!0},import:{value:function(){var e=new mn(1,this);return e.import.apply(e,arguments)},writable:!0,configurable:!0},value:{value:async function(e){var t=this._scope.get(e);if(!t)throw new cn(e+" is not defined");if(t._observer!==gn)return An(this._runtime,t);t=this.variable(!0).define([e],dn);try{return await An(this._runtime,t)}finally{t.delete()}},writable:!0,configurable:!0},variable:{value:function(e){return new mn(1,this,e)},writable:!0,configurable:!0},builtin:{value:function(e,t){this._builtins.set(e,t)},writable:!0,configurable:!0}});const Dn="function"==typeof requestAnimationFrame?requestAnimationFrame:"function"==typeof setImmediate?setImmediate:e=>setTimeout(e,0);var Cn={},Fn={},On={};function Nn(e=new un,t=Hn){var n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(var s in e)new mn(2,n).define(s,[],e[s])}function Tn(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function kn(e){++e._indegree}function $n(e){--e._indegree}function Ln(e){return e._promise.catch(e._rejector)}function Rn(e){return new Promise((function(t){e._invalidate=t}))}function Pn(e,t){let n,s,o="function"==typeof IntersectionObserver&&t._observer&&t._observer._node,i=!o,r=pn,a=pn;return o&&(s=new IntersectionObserver((([e])=>(i=e.isIntersecting)&&(n=null,r()))),s.observe(o),e.then((()=>(s.disconnect(),s=null,a())))),function(e){return i?Promise.resolve(e):s?(n||(n=new Promise(((e,t)=>(r=e,a=t)))),n.then((()=>e))):Promise.reject()}}function Bn(e){e._invalidate(),e._invalidate=pn,e._pending();const t=e._value,n=++e._version;let s=null;const o=e._promise=(e._inputs.length?Promise.all(e._inputs.map(Ln)).then((function(o){if(e._version!==n)throw wn;for(var i=0,r=o.length;i<r;++i)switch(o[i]){case Fn:o[i]=s=Rn(e);break;case On:s||(s=Rn(e)),o[i]=Pn(s,e);break;case Cn:o[i]=e}return e._definition.apply(t,o)})):new Promise((n=>n(e._definition.call(t))))).then((function(t){if(e._version!==n)throw wn;if(function(e){return e&&"function"==typeof e.next&&"function"==typeof e.return}(t))return(s||Rn(e)).then((o=t,function(){o.return()})),function(e,t,n){const s=e._module._runtime;let o;function i(e){return new Promise((e=>e(n.next(o)))).then((({done:t,value:n})=>t?void 0:Promise.resolve(n).then(e)))}function r(){const n=i((i=>{if(e._version!==t)throw wn;return o=i,a(i,n).then((()=>s._precompute(r))),e._fulfilled(i),i}));n.catch((s=>{s!==wn&&e._version===t&&(a(void 0,n),e._rejected(s))}))}function a(t,n){return e._value=t,e._promise=n,e._outputs.forEach(s._updates.add,s._updates),s._compute()}return i((n=>{if(e._version!==t)throw wn;return o=n,s._precompute(r),n}))}(e,n,t);var o;return t}));o.then((t=>{e._value=t,e._fulfilled(t)}),(t=>{t!==wn&&(e._value=void 0,e._rejected(t))}))}function Mn(e,t){e._invalidate(),e._invalidate=pn,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(pn),e._value=void 0,e._rejected(t)}function Hn(e){return window[e]}Object.defineProperties(Nn,{load:{value:function(e,t,n){if("function"==typeof t&&(n=t,t=null),"function"!=typeof n)throw new Error("invalid observer");null==t&&(t=new un);const{modules:s,id:o}=e,i=new Map,r=new Nn(t),a=u(o);function u(e){let t=i.get(e);return t||i.set(e,t=r.module()),t}for(const e of s){const t=u(e.id);let s=0;for(const o of e.variables)o.from?t.import(o.remote,o.name,u(o.from)):t===a?t.variable(n(o,s,e.variables)).define(o.name,o.inputs,o.value):t.define(o.name,o.inputs,o.value),++s}return r},writable:!0,configurable:!0}}),Object.defineProperties(Nn.prototype,{_precompute:{value:function(e){this._precomputes.push(e),this._compute()},writable:!0,configurable:!0},_compute:{value:function(){return this._computing||(this._computing=this._computeSoon())},writable:!0,configurable:!0},_computeSoon:{value:function(){return new Promise(Dn).then((()=>this._disposed?void 0:this._computeNow()))},writable:!0,configurable:!0},_computeNow:{value:async function(){var e,t,n=[],s=this._precomputes;if(s.length){this._precomputes=[];for(const e of s)e();await function(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then((()=>{}));return t}(3)}(e=new Set(this._dirty)).forEach((function(t){t._inputs.forEach(e.add,e);const n=function(e){if(e._observer!==gn)return!0;var t=new Set(e._outputs);for(const e of t){if(e._observer!==gn)return!0;e._outputs.forEach(t.add,t)}return!1}(t);n>t._reachable?this._updates.add(t):n<t._reachable&&t._invalidate(),t._reachable=n}),this),(e=new Set(this._updates)).forEach((function(t){t._reachable?(t._indegree=0,t._outputs.forEach(e.add,e)):(t._indegree=NaN,e.delete(t))})),this._computing=null,this._updates.clear(),this._dirty.clear(),e.forEach((function(e){e._outputs.forEach(kn)}));do{for(e.forEach((function(e){0===e._indegree&&n.push(e)}));t=n.pop();)Bn(t),t._outputs.forEach(o),e.delete(t);e.forEach((function(t){Tn(t)&&(Mn(t,new cn("circular definition")),t._outputs.forEach($n),e.delete(t))}))}while(e.size);function o(e){0==--e._indegree&&n.push(e)}},writable:!0,configurable:!0},dispose:{value:function(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach((e=>{e._invalidate(),e._version=NaN}))},writable:!0,configurable:!0},module:{value:function(e,t=pn){let n;if(void 0===e)return(n=this._init)?(this._init=null,n):new Sn(this);if(n=this._modules.get(e),n)return n;this._init=n=new Sn(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n},writable:!0,configurable:!0},fileAttachments:{value:function(e){return Object.assign((t=>{const n=e(t+="");if(null==n)throw new Error(`File not found: ${t}`);if("object"==typeof n&&"url"in n){const{url:e,mimeType:s}=n;return new Ct(e,t,s)}return new Ct(n,t)}),{prototype:Ct.prototype})},writable:!0,configurable:!0}}),Nn.prototype.fileAttachments((function(e){return e}));const In=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","BR","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","TABLE","UL","TR","TH","TD","COLGROUP","COL","CAPTION","THEAD","TBODY","TFOOT"],jn=/[\t-\r -#%-\*,-\/:;\?@\[-\]_\{\}\x85\xA0\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E44\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC9\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD807[\uDC41-\uDC45\uDC70\uDC71]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/u,Un={NO_SUFFIX_MATCH:0,SUFFIX_MATCH:1,MISPLACED_SUFFIX:2},qn=(e,t,n,s)=>{const o=s.createRange();o.setStart(t.endContainer,t.endOffset),o.setEnd(n.endContainer,n.endOffset),Xn(o);const i=Kn(e,o);return null==i?Un.NO_SUFFIX_MATCH:0!==i.compareBoundaryPoints(Range.START_TO_START,o)?Un.MISPLACED_SUFFIX:Un.SUFFIX_MATCH},Wn=(e,t,n)=>{try{e.setStart(t,n+1)}catch(n){e.setStartAfter(t)}},Xn=e=>{const t=Yn(e);let n=t.nextNode();for(;!e.collapsed&&null!=n;){if(n!==e.startContainer&&e.setStart(n,0),n.textContent.length>e.startOffset){if(!n.textContent[e.startOffset].match(/\s/))return}try{e.setStart(n,e.startOffset+1)}catch(s){n=t.nextNode(),null==n?e.collapse():e.setStart(n,0)}}},Yn=e=>document.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,(t=>Gn(t,e))),zn=e=>{let t=e;for(;null!=t&&!(t instanceof HTMLElement);)t=t.parentNode;if(null!=t){const e=window.getComputedStyle(t);if("hidden"===e.visibility||"none"===e.display||0===e.height||0===e.width||0===e.opacity)return!1}return!0},Vn=(e,t)=>(null==t||t.intersectsNode(e))&&zn(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT,Gn=(e,t)=>(null==t||t.intersectsNode(e))&&zn(e)?e.nodeType===Node.TEXT_NODE?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT,Zn=(e,t)=>{const n=[];let s=[];const o=Array.from(function*(e,t){const n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:t}),s=new Set;for(;null!==ss(n,s);)yield n.currentNode}(e,(e=>Vn(e,t))));for(const e of o)e.nodeType===Node.TEXT_NODE?s.push(e):e instanceof HTMLElement&&In.includes(e.tagName)&&s.length>0&&(n.push(s),s=[]);return s.length>0&&n.push(s),n};const Kn=(e,t)=>{const n=Zn(t.commonAncestorContainer,t),s=ns();for(const o of n){const n=Jn(e,t,o,s);if(void 0!==n)return n}},Jn=(e,t,n,s)=>{if(!e||!t||!(n||[]).length)return;const o=ts(((e,t,n)=>{let s="";return s=1===e.length?e[0].textContent.substring(t,n):e[0].textContent.substring(t)+e.slice(1,-1).reduce(((e,t)=>e+t.textContent),"")+e.slice(-1)[0].textContent.substring(0,n),s.replace(/[\t\n\r ]+/g," ")})(n,0,void 0)),i=ts(e);let r,a,u=n[0]===t.startNode?t.startOffset:0;for(;u<o.length;){const e=o.indexOf(i,u);if(-1===e)return;if(es(o,e,i.length,s)&&(r=Qn(e,n,!1),a=Qn(e+i.length,n,!0)),null!=r&&null!=a){const e=new Range;if(e.setStart(r.node,r.offset),e.setEnd(a.node,a.offset),t.compareBoundaryPoints(Range.START_TO_START,e)<=0&&t.compareBoundaryPoints(Range.END_TO_END,e)>=0)return e}u=e+1}},Qn=(e,t,n)=>{let s,o=0;for(let i=0;i<t.length;i++){const r=t[i];s||(s=ts(r.data));let a=o+s.length;if(n&&(a+=1),a>e){const t=e-o;let i=Math.min(e-o,r.data.length);const a=n?s.substring(0,t):s.substring(t);let u=ts(n?r.data.substring(0,i):r.data.substring(i));const l=(n?-1:1)*(a.length>u.length?-1:1);for(;i>=0&&i<=r.data.length;){if(u.length===a.length)return{node:r,offset:i};i+=l,u=ts(n?r.data.substring(0,i):r.data.substring(i))}}if(o+=s.length,i+1<t.length){const e=ts(t[i+1].data);" "===s.slice(-1)&&" "===e.slice(0,1)&&(o-=1),s=e}}},es=(e,t,n,s)=>{if(t<0||t>=e.length||n<=0||t+n>e.length)return!1;if(s){const o=s.segment(e),i=o.containing(t);if(!i)return!1;if(i.isWordLike&&i.index!=t)return!1;const r=t+n,a=o.containing(r);if(a&&a.isWordLike&&a.index!=r)return!1}else{if(e[t].match(jn)&&(++t,!--n))return!1;if(e[t+n-1].match(jn)&&!--n)return!1;if(0!==t&&!e[t-1].match(jn))return!1;if(t+n!==e.length&&!e[t+n].match(jn))return!1}return!0},ts=e=>(e||"").normalize("NFKD").replace(/\s+/g," ").replace(/[\u0300-\u036f]/g,"").toLowerCase(),ns=()=>{if(Intl.Segmenter){let e=document.documentElement.lang;return e||(e=navigator.languages),new Intl.Segmenter(e,{granularity:"word"})}},ss=(e,t)=>{if(!t.has(e.currentNode)){const t=e.firstChild();if(null!==t)return t}const n=e.nextSibling();if(null!==n)return n;const s=e.parentNode();return null!==s&&t.add(s),s},os={BLOCK_ELEMENTS:In,BOUNDARY_CHARS:jn,NON_BOUNDARY_CHARS:/[^\t-\r -#%-\*,-\/:;\?@\[-\]_\{\}\x85\xA0\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061E\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u0AF0\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166D\u166E\u1680\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2000-\u200A\u2010-\u2029\u202F-\u2043\u2045-\u2051\u2053-\u205F\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E44\u3000-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC9\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDF3C-\uDF3E]|\uD807[\uDC41-\uDC45\uDC70\uDC71]|\uD809[\uDC70-\uDC74]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/u,acceptNodeIfVisibleInRange:Vn,normalizeString:ts,makeNewSegmenter:ns,forwardTraverse:ss,backwardTraverse:(e,t)=>{if(!t.has(e.currentNode)){const t=e.lastChild();if(null!==t)return t}const n=e.previousSibling();if(null!==n)return n;const s=e.parentNode();return null!==s&&t.add(s),s},makeTextNodeWalker:Yn,isNodeVisible:zn};"undefined"!=typeof goog&&goog.declareModuleId("googleChromeLabs.textFragmentPolyfill.textFragmentUtils");let is;const rs=0,as=1,us=2,ls=3,cs=4,hs=(e,t)=>{let n;fs(t);try{n=e.getRangeAt(0)}catch{return{status:as}}Cs(n),Ts(n);const s=n.cloneRange();if(Fs(n),n.collapsed)return{status:as};let o;if(ws(n)){const e=os.normalizeString(n.toString()),t={textStart:e};if(e.length>=20&&_s(t))return{status:rs,fragment:t};o=(new ms).setExactTextMatch(e)}else{const e=ps(n),t=gs(n);o=e&&t?(new ms).setStartAndEndSearchSpace(e,t):(new ms).setSharedSearchSpace(n.toString().trim())}const i=document.createRange();i.selectNodeContents(document.body);const r=i.cloneRange();i.setEnd(s.startContainer,s.startOffset),r.setStart(s.endContainer,s.endOffset);const a=gs(i),u=ps(r);(a||u)&&o.setPrefixAndSuffixSearchSpace(a,u),o.useSegmenter(os.makeNewSegmenter());let l=!1;do{ds(),l=o.embiggen();const e=o.tryToMakeUniqueFragment();if(null!=e)return{status:rs,fragment:e}}while(l);return{status:us}},ds=()=>{const e=Date.now()-is;if(e>500){const t=new Error(`Fragment generation timed out after ${e} ms.`);throw t.isTimeout=!0,t}},fs=e=>{is=e},ps=e=>{let t=Es(e);const n=Ds(t,e.endContainer);if(!n)return;const s=new Set;e.startContainer.nodeType===Node.ELEMENT_NODE&&e.startOffset===e.startContainer.childNodes.length&&s.add(e.startContainer);const o=t,i=new vs(e,!0),r=e.cloneRange();for(;!r.collapsed&&null!=t;){if(ds(),t.contains(o)?r.setStartAfter(t):r.setStartBefore(t),i.appendNode(t),null!==i.textInBlock)return i.textInBlock;t=os.forwardTraverse(n,s)}},gs=e=>{let t=ys(e);const n=Ds(t,e.startContainer);if(!n)return;const s=new Set;e.endContainer.nodeType===Node.ELEMENT_NODE&&0===e.endOffset&&s.add(e.endContainer);const o=t,i=new vs(e,!1),r=e.cloneRange();for(;!r.collapsed&&null!=t;){if(ds(),t.contains(o)?r.setEnd(t,0):r.setEndAfter(t),i.appendNode(t),null!==i.textInBlock)return i.textInBlock;t=os.backwardTraverse(n,s)}},ms=class{constructor(){this.Mode={ALL_PARTS:1,SHARED_START_AND_END:2,CONTEXT_ONLY:3},this.startOffset=null,this.endOffset=null,this.prefixOffset=null,this.suffixOffset=null,this.prefixSearchSpace="",this.backwardsPrefixSearchSpace="",this.suffixSearchSpace="",this.numIterations=0}tryToMakeUniqueFragment(){let e;if(e=this.mode===this.Mode.CONTEXT_ONLY?{textStart:this.exactTextMatch}:{textStart:this.getStartSearchSpace().substring(0,this.startOffset).trim(),textEnd:this.getEndSearchSpace().substring(this.endOffset).trim()},null!=this.prefixOffset){const t=this.getPrefixSearchSpace().substring(this.prefixOffset).trim();t&&(e.prefix=t)}if(null!=this.suffixOffset){const t=this.getSuffixSearchSpace().substring(0,this.suffixOffset).trim();t&&(e.suffix=t)}return _s(e)?e:void 0}embiggen(){let e=!0;if(this.mode===this.Mode.SHARED_START_AND_END?this.startOffset>=this.endOffset&&(e=!1):this.mode===this.Mode.ALL_PARTS?this.startOffset===this.getStartSearchSpace().length&&this.backwardsEndOffset()===this.getEndSearchSpace().length&&(e=!1):this.mode===this.Mode.CONTEXT_ONLY&&(e=!1),e){const e=this.getNumberOfRangeWordsToAdd();if(this.startOffset<this.getStartSearchSpace().length){let t=0;if(null!=this.getStartSegments())for(;t<e&&this.startOffset<this.getStartSearchSpace().length;)this.startOffset=this.getNextOffsetForwards(this.getStartSegments(),this.startOffset,this.getStartSearchSpace()),t++;else{let n=this.startOffset;do{ds();const e=this.getStartSearchSpace().substring(this.startOffset+1).search(os.BOUNDARY_CHARS);this.startOffset=-1===e?this.getStartSearchSpace().length:this.startOffset+1+e,-1!==this.getStartSearchSpace().substring(n,this.startOffset).search(os.NON_BOUNDARY_CHARS)&&(n=this.startOffset,t++)}while(this.startOffset<this.getStartSearchSpace().length&&t<e)}this.mode===this.Mode.SHARED_START_AND_END&&(this.startOffset=Math.min(this.startOffset,this.endOffset))}if(this.backwardsEndOffset()<this.getEndSearchSpace().length){let t=0;if(null!=this.getEndSegments())for(;t<e&&this.endOffset>0;)this.endOffset=this.getNextOffsetBackwards(this.getEndSegments(),this.endOffset),t++;else{let n=this.backwardsEndOffset();do{ds();const e=this.getBackwardsEndSearchSpace().substring(this.backwardsEndOffset()+1).search(os.BOUNDARY_CHARS);-1===e?this.setBackwardsEndOffset(this.getEndSearchSpace().length):this.setBackwardsEndOffset(this.backwardsEndOffset()+1+e),-1!==this.getBackwardsEndSearchSpace().substring(n,this.backwardsEndOffset()).search(os.NON_BOUNDARY_CHARS)&&(n=this.backwardsEndOffset(),t++)}while(this.backwardsEndOffset()<this.getEndSearchSpace().length&&t<e)}this.mode===this.Mode.SHARED_START_AND_END&&(this.endOffset=Math.max(this.startOffset,this.endOffset))}}let t=!1;if((!e||this.startOffset+this.backwardsEndOffset()<20||this.numIterations>=1)&&(null!=this.backwardsPrefixOffset()&&this.backwardsPrefixOffset()!==this.getPrefixSearchSpace().length||null!=this.suffixOffset&&this.suffixOffset!==this.getSuffixSearchSpace().length)&&(t=!0),t){const e=this.getNumberOfContextWordsToAdd();if(this.backwardsPrefixOffset()<this.getPrefixSearchSpace().length){let t=0;if(null!=this.getPrefixSegments())for(;t<e&&this.prefixOffset>0;)this.prefixOffset=this.getNextOffsetBackwards(this.getPrefixSegments(),this.prefixOffset),t++;else{let n=this.backwardsPrefixOffset();do{ds();const e=this.getBackwardsPrefixSearchSpace().substring(this.backwardsPrefixOffset()+1).search(os.BOUNDARY_CHARS);-1===e?this.setBackwardsPrefixOffset(this.getBackwardsPrefixSearchSpace().length):this.setBackwardsPrefixOffset(this.backwardsPrefixOffset()+1+e),-1!==this.getBackwardsPrefixSearchSpace().substring(n,this.backwardsPrefixOffset()).search(os.NON_BOUNDARY_CHARS)&&(n=this.backwardsPrefixOffset(),t++)}while(this.backwardsPrefixOffset()<this.getPrefixSearchSpace().length&&t<e)}}if(this.suffixOffset<this.getSuffixSearchSpace().length){let t=0;if(null!=this.getSuffixSegments())for(;t<e&&this.suffixOffset<this.getSuffixSearchSpace().length;)this.suffixOffset=this.getNextOffsetForwards(this.getSuffixSegments(),this.suffixOffset,this.suffixOffset),t++;else{let n=this.suffixOffset;do{ds();const e=this.getSuffixSearchSpace().substring(this.suffixOffset+1).search(os.BOUNDARY_CHARS);this.suffixOffset=-1===e?this.getSuffixSearchSpace().length:this.suffixOffset+1+e,-1!==this.getSuffixSearchSpace().substring(n,this.suffixOffset).search(os.NON_BOUNDARY_CHARS)&&(n=this.suffixOffset,t++)}while(this.suffixOffset<this.getSuffixSearchSpace().length&&t<e)}}}return this.numIterations++,e||t}setStartAndEndSearchSpace(e,t){return this.startSearchSpace=e,this.endSearchSpace=t,this.backwardsEndSearchSpace=bs(t),this.startOffset=0,this.endOffset=t.length,this.mode=this.Mode.ALL_PARTS,this}setSharedSearchSpace(e){return this.sharedSearchSpace=e,this.backwardsSharedSearchSpace=bs(e),this.startOffset=0,this.endOffset=e.length,this.mode=this.Mode.SHARED_START_AND_END,this}setExactTextMatch(e){return this.exactTextMatch=e,this.mode=this.Mode.CONTEXT_ONLY,this}setPrefixAndSuffixSearchSpace(e,t){return e&&(this.prefixSearchSpace=e,this.backwardsPrefixSearchSpace=bs(e),this.prefixOffset=e.length),t&&(this.suffixSearchSpace=t,this.suffixOffset=0),this}useSegmenter(e){return null==e||(this.mode===this.Mode.ALL_PARTS?(this.startSegments=e.segment(this.startSearchSpace),this.endSegments=e.segment(this.endSearchSpace)):this.mode===this.Mode.SHARED_START_AND_END&&(this.sharedSegments=e.segment(this.sharedSearchSpace)),this.prefixSearchSpace&&(this.prefixSegments=e.segment(this.prefixSearchSpace)),this.suffixSearchSpace&&(this.suffixSegments=e.segment(this.suffixSearchSpace))),this}getNumberOfContextWordsToAdd(){return 0===this.backwardsPrefixOffset()&&0===this.suffixOffset?3:1}getNumberOfRangeWordsToAdd(){return 0===this.startOffset&&0===this.backwardsEndOffset()?3:1}getNextOffsetForwards(e,t,n){let s=e.containing(t);for(;null!=s;){ds();const t=s.index+s.segment.length;if(s.isWordLike)return t;s=e.containing(t)}return n.length}getNextOffsetBackwards(e,t){let n=e.containing(t);for(n&&t!=n.index||(n=e.containing(t-1));null!=n;){if(ds(),n.isWordLike)return n.index;n=e.containing(n.index-1)}return 0}getStartSearchSpace(){return this.mode===this.Mode.SHARED_START_AND_END?this.sharedSearchSpace:this.startSearchSpace}getStartSegments(){return this.mode===this.Mode.SHARED_START_AND_END?this.sharedSegments:this.startSegments}getEndSearchSpace(){return this.mode===this.Mode.SHARED_START_AND_END?this.sharedSearchSpace:this.endSearchSpace}getEndSegments(){return this.mode===this.Mode.SHARED_START_AND_END?this.sharedSegments:this.endSegments}getBackwardsEndSearchSpace(){return this.mode===this.Mode.SHARED_START_AND_END?this.backwardsSharedSearchSpace:this.backwardsEndSearchSpace}getPrefixSearchSpace(){return this.prefixSearchSpace}getPrefixSegments(){return this.prefixSegments}getBackwardsPrefixSearchSpace(){return this.backwardsPrefixSearchSpace}getSuffixSearchSpace(){return this.suffixSearchSpace}getSuffixSegments(){return this.suffixSegments}backwardsEndOffset(){return this.getEndSearchSpace().length-this.endOffset}setBackwardsEndOffset(e){this.endOffset=this.getEndSearchSpace().length-e}backwardsPrefixOffset(){return null==this.prefixOffset?null:this.getPrefixSearchSpace().length-this.prefixOffset}setBackwardsPrefixOffset(e){null!=this.prefixOffset&&(this.prefixOffset=this.getPrefixSearchSpace().length-e)}},vs=class{constructor(e,t){this.searchRange=e,this.isForwardTraversal=t,this.textFound=!1,this.textNodes=[],this.textInBlock=null}appendNode(e){if(null!==this.textInBlock)return;if(ks(e))return void(this.textFound?(this.isForwardTraversal||this.textNodes.reverse(),this.textInBlock=this.textNodes.map((e=>e.textContent)).join("").trim()):this.textNodes=[]);if(!$s(e))return;const t=this.getNodeIntersectionWithRange(e);this.textFound=this.textFound||""!==t.textContent.trim(),this.textNodes.push(t)}getNodeIntersectionWithRange(e){let t=null,n=null;return e===this.searchRange.startContainer&&0!==this.searchRange.startOffset&&(t=this.searchRange.startOffset),e===this.searchRange.endContainer&&this.searchRange.endOffset!==e.textContent.length&&(n=this.searchRange.endOffset),null!==t||null!==n?{textContent:e.textContent.substring(t??0,n??e.textContent.length)}:e}},_s=e=>1===((e,t=document)=>{const n=[],s=t.createRange();for(s.selectNodeContents(t.body);!s.collapsed&&n.length<2;){let o;if(e.prefix){const n=Kn(e.prefix,s);if(null==n)break;Wn(s,n.startContainer,n.startOffset);const i=t.createRange();if(i.setStart(n.endContainer,n.endOffset),i.setEnd(s.endContainer,s.endOffset),Xn(i),i.collapsed)break;if(o=Kn(e.textStart,i),null==o)break;if(0!==o.compareBoundaryPoints(Range.START_TO_START,i))continue}else{if(o=Kn(e.textStart,s),null==o)break;Wn(s,o.startContainer,o.startOffset)}if(e.textEnd){const i=t.createRange();i.setStart(o.endContainer,o.endOffset),i.setEnd(s.endContainer,s.endOffset);let r=!1;for(;!i.collapsed&&n.length<2;){const a=Kn(e.textEnd,i);if(null==a)break;if(Wn(i,a.startContainer,a.startOffset),o.setEnd(a.endContainer,a.endOffset),e.suffix){const i=qn(e.suffix,o,s,t);if(i===Un.NO_SUFFIX_MATCH)break;if(i===Un.SUFFIX_MATCH){r=!0,n.push(o.cloneRange());continue}if(i===Un.MISPLACED_SUFFIX)continue}else r=!0,n.push(o.cloneRange())}if(!r)break}else if(e.suffix){const i=qn(e.suffix,o,s,t);if(i===Un.NO_SUFFIX_MATCH)break;if(i===Un.SUFFIX_MATCH){n.push(o.cloneRange()),Wn(s,s.startContainer,s.startOffset);continue}if(i===Un.MISPLACED_SUFFIX)continue}else n.push(o.cloneRange())}return n})(e).length,bs=e=>[...e||""].reverse().join(""),ws=e=>!(e.toString().length>300)&&!Ss(e),Es=e=>{let t=e.startContainer;return t.nodeType==Node.ELEMENT_NODE&&e.startOffset<t.childNodes.length&&(t=t.childNodes[e.startOffset]),t},ys=e=>{let t=e.endContainer;return t.nodeType==Node.ELEMENT_NODE&&e.endOffset>0&&(t=t.childNodes[e.endOffset-1]),t},Ss=e=>{const t=e.cloneRange();let n=Es(t);const s=Ds(n);if(!s)return!1;const o=new Set;for(;!t.collapsed&&null!=n;){if(ks(n))return!0;null!=n&&t.setStartAfter(n),n=os.forwardTraverse(s,o),ds()}return!1},As=(e,t)=>{if(e.nodeType!==Node.TEXT_NODE)return-1;const n=null!=t?t:e.data.length;if(n<e.data.length&&os.BOUNDARY_CHARS.test(e.data[n]))return n;const s=e.data.substring(0,n),o=bs(s).search(os.BOUNDARY_CHARS);return-1!==o?n-o:-1},xs=(e,t)=>{if(e.nodeType!==Node.TEXT_NODE)return-1;const n=null!=t?t:0;if(n<e.data.length&&n>0&&os.BOUNDARY_CHARS.test(e.data[n-1]))return n;const s=e.data.substring(n).search(os.BOUNDARY_CHARS);return-1!==s?n+s:-1},Ds=(e,t)=>{if(!e)return;let n=e;const s=null!=t?t:e;for(;!n.contains(s)||!ks(n);)n.parentNode&&(n=n.parentNode);const o=document.createTreeWalker(n,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,(e=>os.acceptNodeIfVisibleInRange(e)));return o.currentNode=e,o},Cs=e=>{const t=os.makeNewSegmenter();if(t){const n=Es(e);n!==e.startContainer&&e.setStartBefore(n),Os(t,!1,e)}else{const t=As(e.startContainer,e.startOffset);if(-1!==t)return void e.setStart(e.startContainer,t);if(ks(e.startContainer)&&0===e.startOffset)return;const n=Ds(e.startContainer);if(!n)return;const s=new Set;let o=os.backwardTraverse(n,s);for(;null!=o;){const t=As(o);if(-1!==t)return void e.setStart(o,t);if(ks(o))return void(o.contains(e.startContainer)?e.setStart(o,0):e.setStartAfter(o));o=os.backwardTraverse(n,s),e.collapse()}}},Fs=e=>{const t=(e=>{const t=Es(e);if($s(t)&&os.isNodeVisible(t))return t;const n=os.makeTextNodeWalker(e);return n.currentNode=t,n.nextNode()})(e);if(null==t)return void e.collapse();Es(e)!==t&&e.setStart(t,0);const n=ys(e),s=(e=>{const t=ys(e);if($s(t)&&os.isNodeVisible(t))return t;const n=os.makeTextNodeWalker(e);return n.currentNode=t,os.backwardTraverse(n,new Set)})(e);n!==s&&e.setEnd(s,s.textContent.length)},Os=(e,t,n)=>{const s=t?{node:n.endContainer,offset:n.endOffset}:{node:n.startContainer,offset:n.startOffset},o=Ns(s.node),i=o.preNodes.reduce(((e,t)=>e.concat(t.textContent)),""),r=o.innerNodes.reduce(((e,t)=>e.concat(t.textContent)),"");let a=i.length;s.node.nodeType===Node.TEXT_NODE?a+=s.offset:t&&(a+=r.length);const u=o.postNodes.reduce(((e,t)=>e.concat(t.textContent)),""),l=[...o.preNodes,...o.innerNodes,...o.postNodes];if(0==l.length)return;const c=i.concat(r,u),h=e.segment(c).containing(a);if(!h)return void(t?n.setEndAfter(l[l.length-1]):n.setEndBefore(l[0]));if(!h.isWordLike)return;if(a===h.index||a===h.index+h.segment.length)return;const d=t?h.index+h.segment.length:h.index;let f=0;for(const e of l){if(f<=d&&d<f+e.textContent.length){const s=d-f;return void(t?s>=e.textContent.length?n.setEndAfter(e):n.setEnd(e,s):s>=e.textContent.length?n.setStartAfter(e):n.setStart(e,s))}f+=e.textContent.length}t?n.setEndAfter(l[l.length-1]):n.setStartBefore(l[0])},Ns=e=>{const t=[],n=Ds(e);if(!n)return;const s=new Set;let o=os.backwardTraverse(n,s);for(;null!=o&&!ks(o);)ds(),o.nodeType===Node.TEXT_NODE&&t.push(o),o=os.backwardTraverse(n,s);t.reverse();const i=[];if(e.nodeType===Node.TEXT_NODE)i.push(e);else{const t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,(e=>os.acceptNodeIfVisibleInRange(e)));t.currentNode=e;let n=t.nextNode();for(;null!=n;)ds(),n.nodeType===Node.TEXT_NODE&&i.push(n),n=t.nextNode()}const r=[],a=Ds(e);if(!a)return;const u=new Set([e]);let l=os.forwardTraverse(a,u);for(;null!=l&&!ks(l);)ds(),l.nodeType===Node.TEXT_NODE&&r.push(l),l=os.forwardTraverse(a,u);return{preNodes:t,innerNodes:i,postNodes:r}},Ts=e=>{const t=os.makeNewSegmenter();if(t){const n=ys(e);n!==e.endContainer&&e.setEndAfter(n),Os(t,!0,e)}else{let t=e.endOffset,n=e.endContainer;n.nodeType===Node.ELEMENT_NODE&&e.endOffset<n.childNodes.length&&(n=n.childNodes[e.endOffset]);const s=Ds(n);if(!s)return;const o=new Set([n]);for(;null!=n;){ds();const i=xs(n,t);if(t=null,-1!==i)return void e.setEnd(n,i);if(ks(n))return void(n.contains(e.endContainer)?e.setEnd(n,n.childNodes.length):e.setEndBefore(n));n=os.forwardTraverse(s,o)}e.collapse()}},ks=e=>e.nodeType===Node.ELEMENT_NODE&&(os.BLOCK_ELEMENTS.includes(e.tagName)||"HTML"===e.tagName||"BODY"===e.tagName),$s=e=>e.nodeType===Node.TEXT_NODE;"undefined"!=typeof goog&&goog.declareModuleId("googleChromeLabs.textFragmentPolyfill.fragmentGenerationUtils");const Ls=["ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","BR","DETAILS","DIALOG","DD","DIV","DL","DT","FIELDSET","FIGCAPTION","FIGURE","FOOTER","FORM","H1","H2","H3","H4","H5","H6","HEADER","HGROUP","HR","LI","MAIN","NAV","OL","P","PRE","SECTION","TABLE","UL","TR","TH","TD","COLGROUP","COL","CAPTION","THEAD","TBODY","TFOOT"],Rs=(e,t)=>(null==t||t.intersectsNode(e))&&(e=>{let t=e;for(;null!=t&&!(t instanceof HTMLElement);)t=t.parentNode;if(null!=t){const e=window.getComputedStyle(t);if("hidden"===e.visibility||"none"===e.display||0===e.height||0===e.width||0===e.opacity)return!1}return!0})(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT,Ps=(e,t)=>{const n=[];let s=[];const o=Array.from(function*(e,t){const n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:t}),s=new Set;for(;null!==Bs(n,s);)yield n.currentNode}(e,(e=>"katex-mathml"!==e.className&&Rs(e,t))));for(const e of o)e.nodeType===Node.TEXT_NODE?s.push(e):e instanceof HTMLElement&&Ls.includes(e.tagName)&&s.length>0&&(n.push(s),s=[]);return s.length>0&&n.push(s),n};const Bs=(e,t)=>{if(!t.has(e.currentNode)){const t=e.firstChild();if(null!==t)return t}const n=e.nextSibling();if(null!==n)return n;const s=e.parentNode();return null!==s&&t.add(s),s};function Ms(e){let t=Object.assign({container:document.body,theme:"dark",useAlpha:!0,color:{r:250,g:250,b:68}},e),n=this,s={color_wheel:null,brightness_slider:null,tab_selection_buttons:null,red_input:null,green_input:null,blue_input:null,hue_input:null,saturation_input:null,brightness_input:null,hex_input:null,alpha_input:null},o={color_change:null,color_wheel_change:null,brightness_slider_change:null,tab_selection_change:null,hue_input_change:null,saturation_input_change:null,brightness_input_change:null,red_input_change:null,green_input_change:null,blue_input_change:null,alpha_input_change:null,hex_input_change:null},i={hsvToHsl:function(e,t,n){const s=(2-(t/=100))*(n/=100)/2;return 0!==s&&(t=1===s?0:s<.5?t*n/(2*s):t*n/(2-2*s)),[e,100*t,100*s]},hslToHsv:function(e,t,n){t/=100;const s=2*(t*=(n/=100)<.5?n:1-n)/(n+t)*100,o=100*(n+t);return[e,isNaN(s)?0:s,o]},hsvToRgb:function(e,t,n){e=e/360*6,t/=100,n/=100;const s=Math.floor(e),o=e-s,i=n*(1-t),r=n*(1-o*t),a=n*(1-(1-o)*t),u=s%6;return[255*[n,r,i,i,a,n][u],255*[a,n,n,r,i,i][u],255*[i,i,a,n,n,r][u]]},rgbToHsv:function(e,t,n){e/=255,t/=255,n/=255;const s=Math.min(e,t,n),o=Math.max(e,t,n),i=o-s;let r,a;if(0===i)r=a=0;else{a=i/o;const s=((o-e)/6+i/2)/i,u=((o-t)/6+i/2)/i,l=((o-n)/6+i/2)/i;e===o?r=l-u:t===o?r=1/3+s-l:n===o&&(r=2/3+u-s),r<0?r+=1:r>1&&(r-=1)}return[360*r,100*a,100*o]},hsvToHex:function(e,t,n){return i.hsvToRgb(e,t,n).map((e=>Math.round(e).toString(16).padStart(2,"0")))},hexToHsv:function(e){return e=e.trim().toLowerCase().replace(/ /g,"").replace(/[^A-Za-z0-9\s]/g,""),i.rgbToHsv(...e.match(/.{2}/g).map((e=>parseInt(e,16))))},hexToRgb:function(e){let t,n,s;return t=(e=e.trim().toLowerCase().replace(/ /g,"").replace(/[^A-Za-z0-9\s]/g,"")).charAt(0)+""+e.charAt(1),n=e.charAt(2)+""+e.charAt(3),s=e.charAt(4)+""+e.charAt(5),t=parseInt(t,16),n=parseInt(n,16),s=parseInt(s,16),[t,n,s]},getBoundingBox:function(e){let t=e.getBoundingClientRect();return{top:t.top+(window.pageYOffset||document.documentElement.scrollTop),left:t.left+(window.pageXOffset||document.documentElement.scrollLeft),width:t.width,height:t.height}},degreesToRadians:function(e){return e*(Math.PI/180)},countDecimals:function(e){return Math.floor(e.valueOf())===e.valueOf()?0:e.toString().split(".")[1].length||0},round:function(e,t){let n=Number(Math.round(e+"e"+t)+"e-"+t);return isNaN(n)?0:n}},r={open:[],change:[],close:[]};this.root=document.createElement("div"),this.container=t.container;let a=!0;Object.defineProperty(n,"isOpen",{get:function(){return a},set:function(e){null!=e&&(a=e,n.root.style.visibility=a?"visible":"collapse",l(a?"open":"close",n))},enumerable:!0,configurable:!0});let u=(new f).fromRGBa(t.color.r||255,t.color.g||255,t.color.b||255);Object.defineProperty(n,"color",{get:function(){return u},set:function(e){e instanceof f&&(u.dispose(),u=e,l("change",n.value))},enumerable:!0,configurable:!0});let l=function(e,...t){r[e].forEach((e=>e(...t,n)))};this.on=function(e,t){return r[e]=r[e]||[],r[e].push(t),this},this.off=function(e,t){const n=r[e]||[],s=n.indexOf(t);return~s&&n.splice(s,1),this};let c=function(){n.root.innerHTML='\n            <div class="color-picker"> \n            <div class="color-picker-controls">\n                <div class="color-picker-controls-group" style="display: flex; flex-direction: row;height: 160px;">\n                    <div class="color-picker-brightness-control">\n                        <canvas id="brightness-canvas" class="brightness-canvas"></canvas>\n                        <div class="color-picker-brightness-control-thumb" style="bottom: 0; left: 50%;"></div>\n                    </div>\n                    <div class="color-picker-wheel-control">\n                        <canvas id="wheel-canvas" class="wheel-canvas"></canvas>\n                        <div class="color-picker-wheel-control-thumb" style="top:50%; left: 50%;"></div>\n                    </div>\n                </div>\n                <div class="color-picker-controls-group" style="flex: 1; padding-top: 0;">\n                    <div class="color-picker-input-controls">\n                        <div class="color-picker-input-controls-tab-headers">\n                            <button data-tab="rgb">RGB</button>\n                            <button data-tab="hsv" class="selected">HSV</button>\n                            <button data-tab="hex">HEX</button>\n                        </div>\n                        <div class="color-picker-input-controls-tabs">\n                            <div class="color-picker-input-controls-tab" data-tab="rgb">\n                                <div class="color-picker-red-input range-input-control" data-value="0" data-step="0.01" data-min="0" data-max="255">\n                                    <div class="range-input-enter-block">\n                                        <input class="range-input" type="number">\n                                    </div>\n                                    <div class="range-input-details-block">\n                                        <span class="range-input-progress"></span>\n                                        <span class="range-input-label">R:</span>\n                                        <span class="range-input-value">0.00</span>\n                                    </div>\n                                </div>\n                                <div class="color-picker-green-input range-input-control" data-value="0" data-step="0.01" data-min="0" data-max="255">\n                                    <div class="range-input-enter-block">\n                                        <input class="range-input" type="number">\n                                    </div>\n                                    <div class="range-input-details-block">\n                                        <span class="range-input-progress"></span>\n                                        <span class="range-input-label">G:</span>\n                                        <span class="range-input-value">0.00</span>\n                                    </div>\n                                </div>\n                                <div class="color-picker-blue-input range-input-control" data-value="0" data-step="0.01" data-min="0" data-max="255">\n                                    <div class="range-input-enter-block">\n                                        <input class="range-input" type="number">\n                                    </div>\n                                    <div class="range-input-details-block">\n                                        <span class="range-input-progress"></span>\n                                        <span class="range-input-label">B:</span>\n                                        <span class="range-input-value">0.00</span>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="color-picker-input-controls-tab selected" data-tab="hsv">\n                                <div class="color-picker-hue-input range-input-control" data-value="0" data-step="0.01" data-min="0" data-max="360">\n                                    <div class="range-input-enter-block">\n                                        <input class="range-input" type="number">\n                                    </div>\n                                    <div class="range-input-details-block">\n                                        <span class="range-input-progress"></span>\n                                        <span class="range-input-label">H:</span>\n                                        <span class="range-input-value">0.00</span>\n                                    </div>\n                                </div>\n                                <div class="color-picker-saturation-input range-input-control" data-value="0" data-step="0.01" data-min="0" data-max="100">\n                                    <div class="range-input-enter-block">\n                                        <input class="range-input" type="number">\n                                    </div>\n                                    <div class="range-input-details-block">\n                                        <span class="range-input-progress"></span>\n                                        <span class="range-input-label">S:</span>\n                                        <span class="range-input-value">0.00</span>\n                                    </div>\n                                </div>\n                                <div class="color-picker-brightness-input range-input-control" data-value="0" data-step="0.01" data-min="0" data-max="100">\n                                    <div class="range-input-enter-block">\n                                        <input class="range-input" type="number">\n                                    </div>\n                                    <div class="range-input-details-block">\n                                        <span class="range-input-progress"></span>\n                                        <span class="range-input-label">V:</span>\n                                        <span class="range-input-value">0.00</span>\n                                    </div>\n                                </div>\n                            </div>\n                            <div class="color-picker-input-controls-tab" data-tab="hex">\n                                <div class="color-picker-hex-input text-input-control" data-value="000000" data-is-alphanumeric="true">\n                                    <div class="text-input-enter-block">\n                                        <input class="text-input" type="text">\n                                    </div>\n                                    <div class="text-input-details-block">\n                                        <span class="text-input-label">Hex:</span>\n                                        <span class="text-input-value">000000</span>\n                                    </div>\n                                </div>\n                            </div>'+(t.useAlpha?'<div class="color-picker-alpha-input range-input-control" data-value="255" data-step="0.01" data-min="0" data-max="255">\n                                    <div class="range-input-enter-block">\n                                        <input class="range-input" type="number">\n                                    </div>\n                                    <div class="range-input-details-block">\n                                        <span class="range-input-progress"></span>\n                                        <span class="range-input-label">A:</span>\n                                        <span class="range-input-value">0.00</span>\n                                    </div>\n                                </div>':"")+"</div>\n                    </div>\n                </div>\n            </div>\n        </div>".trim(),n.container.appendChild(n.root),n.root.dataset.theme=t.theme,n.isOpen=t.isOpen,s.color_wheel=new p({color_picker:n}),s.color_wheel.values.hue=n.color.h,s.color_wheel.values.saturation=n.color.s,s.brightness_slider=new g({color_picker:n}),s.brightness_slider.value=n.color.v,s.tab_selection_buttons=n.root.querySelectorAll(".color-picker-input-controls-tab-headers button"),s.red_input=new m(n.root.querySelector(".color-picker-red-input")),s.green_input=new m(n.root.querySelector(".color-picker-green-input")),s.blue_input=new m(n.root.querySelector(".color-picker-blue-input"));let e=i.hsvToRgb(n.color.h,n.color.s,n.color.v);s.red_input.value=e[0],s.green_input.value=e[1],s.blue_input.value=e[2],s.hue_input=new m(n.root.querySelector(".color-picker-hue-input")),s.hue_input.value=n.color.h,s.saturation_input=new m(n.root.querySelector(".color-picker-saturation-input")),s.saturation_input.value=n.color.s,s.brightness_input=new m(n.root.querySelector(".color-picker-brightness-input")),s.brightness_input.value=n.color.v,s.hex_input=new v(n.root.querySelector(".color-picker-hex-input"));let o=i.hsvToHex(n.color.h,n.color.s,n.color.v);s.hex_input.value=o.join("").toUpperCase(),t.useAlpha&&(s.alpha_input=new m(n.root.querySelector(".color-picker-alpha-input")),s.alpha_input.value=n.color.a),h()},h=function(){o.tab_selection_change=function(e){s.tab_selection_buttons.forEach((e=>e.classList.remove("selected"))),n.root.querySelectorAll(".color-picker-input-controls-tab").forEach((e=>e.classList.remove("selected"))),e.target.classList.add("selected"),n.root.querySelector('.color-picker-input-controls-tab[data-tab="'+e.target.dataset.tab+'"]').classList.add("selected")},s.tab_selection_buttons.forEach((e=>e.addEventListener("click",o.tab_selection_change))),o.color_change=()=>n.update(),n.color.on("change",o.color_change),o.color_wheel_change=function(e){n.color.h=e.hue,n.color.s=e.saturation,n.update(),l("change",n.color)},s.color_wheel.on("change",o.color_wheel_change),o.brightness_slider_change=function(e){n.color.v=e,n.update(),l("change",n.color)},s.brightness_slider.on("change",o.brightness_slider_change),o.hue_input_change=function(e){n.color.h=e,n.update(),l("change",n.color)},s.hue_input.on("change",o.hue_input_change),o.saturation_input_change=function(e){n.color.s=e,n.update(),l("change",n.color)},s.saturation_input.on("change",o.saturation_input_change),o.brightness_input_change=function(e){n.color.v=e,n.update(),l("change",n.color)},s.brightness_input.on("change",o.brightness_input_change),o.red_input_change=function(e){let t=i.rgbToHsv(s.red_input.value,s.green_input.value,s.blue_input.value);n.color.h=t[0],n.color.s=t[1],n.color.v=t[2],n.update(),l("change",n.color)},s.red_input.on("change",o.red_input_change),o.green_input_change=function(e){let t=i.rgbToHsv(s.red_input.value,s.green_input.value,s.blue_input.value);n.color.h=t[0],n.color.s=t[1],n.color.v=t[2],n.update(),l("change",n.color)},s.green_input.on("change",o.green_input_change),o.blue_input_change=function(e){let t=i.rgbToHsv(s.red_input.value,s.green_input.value,s.blue_input.value);n.color.h=t[0],n.color.s=t[1],n.color.v=t[2],n.update(),l("change",n.color)},s.blue_input.on("change",o.blue_input_change),o.hex_input_change=function(e){let t=s.hex_input.value.trim().toLowerCase().replace(/ /g,"").replace(/[^A-Za-z0-9\s]/g,""),o=i.hexToHsv(t.padEnd(6,"0"));n.color.h=o[0]||0,n.color.s=o[1]||0,n.color.v=o[2]||0,n.update(),l("change",n.color)},s.hex_input.on("change",o.hex_input_change),t.useAlpha&&(o.alpha_input_change=function(e){n.color.a=e,n.update(),l("change",n.color)},s.alpha_input.on("change",o.alpha_input_change))},d=function(){s.tab_selection_buttons.forEach((e=>e.removeEventListener("click",o.tab_selection_change))),n.color.off("change",o.color_change),s.color_wheel.off("change",o.color_wheel_change),s.brightness_slider.off("change",o.brightness_slider_change),s.hue_input.off("change",o.hue_input_change),s.saturation_input.off("change",o.saturation_input_change),s.brightness_input.off("change",o.brightness_input_change),s.red_input.off("change",o.red_input_change),s.green_input.off("change",o.green_input_change),s.blue_input.off("change",o.blue_input_change),s.hex_input.off("change",o.hex_input_change),t.useAlpha&&s.alpha_input.off("change",o.alpha_input_change)};function f(e=360,t=0,s=100,o=255){this.h=e,this.s=t,this.v=s,this.a=o;let r={change:[]},a=function(e,...t){r[e].forEach((e=>e(...t,n)))};this.on=function(e,t){return r[e]=r[e]||[],r[e].push(t),this},this.off=function(e,t){const n=r[e]||[],s=n.indexOf(t);return~s&&n.splice(s,1),this},this.fromHSVa=function(e=0,t=0,n=0,s=255){return this.h=e,this.s=t,this.v=n,this.a=s,a("change",this),this},this.toHSV=function(){let e=[this.h,this.s,this.v];var t,n;return e.toString=(t=e,n=e=>`hsv(${e[0]}, ${e[1]}%, ${e[2]}%)`,(e=-1)=>n(~e?t.map((t=>Number(t.toFixed(e)))):t)),e},this.toHSVa=function(){let e=[this.h,this.s,this.v,this.a];var t,n;return e.toString=(t=e,n=e=>`hsva(${e[0]}, ${e[1]}%, ${e[2]}%, ${this.a})`,(e=-1)=>n(~e?t.map((t=>Number(t.toFixed(e)))):t)),e},this.fromHSLa=function(e,t,n,s=255){let o=i.hslToHsv(e,t,n);return null!=o?(this.h=o[0]||0,this.s=o[1]||0,this.v=o[2]||0,this.a=s):console.error("Error while parsing hsl into hsv"),a("change",this),this},this.toHSL=function(){let e=[...i.hsvToHsl(this.h,this.s,this.v)];var t,n;return e.toString=(t=e,n=e=>`hsl(${e[0]}, ${e[1]}%, ${e[2]}%)`,(e=-1)=>n(~e?t.map((t=>Number(t.toFixed(e)))):t)),e},this.toHSLa=function(){let e=[...i.hsvToHsl(this.h,this.s,this.v),this.a];var t,n;return e.toString=(t=e,n=e=>`hsla(${e[0]}, ${e[1]}%, ${e[2]}%, ${this.a})`,(e=-1)=>n(~e?t.map((t=>Number(t.toFixed(e)))):t)),e},this.fromRGBa=function(e=0,t=0,n=0,s=255){let o=i.rgbToHsv(e,t,n);return null!=o?(this.h=o[0]||0,this.s=o[1]||0,this.v=o[2]||0,this.a=s):console.error("Error while parsing rgb into hsv"),a("change",this),this},this.toRGB=function(){let e=[...i.hsvToRgb(this.h,this.s,this.v)];var t,n;return e.toString=(t=e,n=e=>`rgb(${e[0]}, ${e[1]}, ${e[2]})`,(e=-1)=>n(~e?t.map((t=>Number(t.toFixed(e)))):t)),e},this.toRGBa=function(){let e=[...i.hsvToRgb(this.h,this.s,this.v),this.a];var t,n;return e.toString=(t=e,n=e=>`rgba(${e[0]}, ${e[1]}, ${e[2]}, ${this.a})`,(e=-1)=>n(~e?t.map((t=>Number(t.toFixed(e)))):t)),e},this.fromHEX=function(e,t=255){e=e.trim().toLowerCase().replace(/ /g,"").replace(/[^A-Za-z0-9\s]/g,"");let n=i.hexToHsv(e.padEnd(6,"0"));return null!=n?(this.h=n[0]||0,this.s=n[1]||0,this.v=n[2]||0,this.a=t):console.error("Error while parsing hex into hsv"),a("change",this),this},this.toHEX=function(){return`#${i.hsvToHex(this.h,this.s,this.v).join("").toUpperCase()}`},this.dispose=function(){for(var e in r.change.splice(0,r.change.length),r.change=null,a=null,this)delete this[e]}}function p({color_picker:e=null}){let t,n=this,s=e.root.querySelector(".color-picker-wheel-control"),o=s.querySelector("canvas"),r=document.createElement("canvas"),a=s.querySelector(".color-picker-wheel-control-thumb"),u=!1,l={thumb_mousedown:null,canvas_mousedown:null,document_mousemove:null,document_mouseup:null},c={change:[]};this.values={};let h=e.color.h;Object.defineProperty(this.values,"hue",{get:function(){return h},set:function(e){null!=e&&(e>360&&(e=360),e<0&&(e=0),h=e,n.update())},enumerable:!0,configurable:!0});let d=e.color.s;Object.defineProperty(this.values,"saturation",{get:function(){return d},set:function(e){null!=e&&(e>100&&(e=100),e<0&&(e=0),d=e,n.update())},enumerable:!0,configurable:!0});let f=function(e,...t){c[e].forEach((e=>e(...t,n)))};this.on=function(e,t){return c[e]=c[e]||[],c[e].push(t),this},this.off=function(e,t){const n=c[e]||[],s=n.indexOf(t);return~s&&n.splice(s,1),this};let p=async function(){await g(),m(),v(),_()},g=async function(){return new Promise(((e,n)=>{let s=document.createElement("canvas");s.width=s.height=512;let o=s.getContext("2d"),i=s.width/2,r=1/i;o.clearRect(0,0,s.width,s.height);let a=i,u=i;for(let e=0;e<360;e+=r){let t=e*(2*Math.PI)/360,n=i*Math.cos(t),s=i*Math.sin(t);o.strokeStyle="hsl("+e+", 100%, 50%)",o.beginPath(),o.moveTo(i,i),o.lineTo(a+n,u+s),o.stroke()}let l=o.createRadialGradient(a,u,0,a,a,i);l.addColorStop(0,"rgba(255, 255, 255, 1)"),l.addColorStop(1,"rgba(255, 255, 255, 0)"),o.fillStyle=l,o.beginPath(),o.arc(a,u,i,0,2*Math.PI,!0),o.closePath(),o.fill(),o.beginPath(),o.strokeStyle="rgb(38, 41, 50)",o.arc(a,u,i,0,2*Math.PI),o.stroke(),t=new Image,t.onload=()=>e(),t.src=s.toDataURL()}))},m=function(){let n=i.getBoundingBox(o);o.width=o.height=n.width,r.width=r.height=n.width;let s=o.getContext("2d"),a=r.getContext("2d");s.translate(o.width/2,o.height/2),s.rotate(90*Math.PI/180),s.translate(-o.width/2,-o.height/2),s.beginPath(),s.arc(o.width/2,o.width/2,o.width/2,0,2*Math.PI),s.clip(),s.closePath();let u=document.createElement("canvas"),l=10;u.width=20,u.height=20;let c=u.getContext("2d"),h="rgba(255, 255, 255, 1)",d="rgba(205, 205,205, 1)";c.beginPath(),c.fillStyle=h,c.fillRect(0,0,l,l),c.closePath(),c.beginPath(),c.fillStyle=d,c.fillRect(l,0,l,l),c.closePath(),c.beginPath(),c.fillStyle=d,c.fillRect(0,l,l,l),c.closePath(),c.beginPath(),c.fillStyle=h,c.fillRect(l,l,l,l),c.closePath();let f=s.createPattern(u,"repeat");s.beginPath(),s.fillStyle=f,s.fillRect(0,0,o.width,o.height),s.closePath(),s.beginPath(),s.strokeStyle="rgb(217, 214, 205)",s.arc(o.width/2,o.width/2,o.width/2,0,2*Math.PI),s.stroke(),s.closePath(),a.drawImage(t,0,0,o.width,o.height),a.fillStyle="rgba(0, 0, 0, "+Math.abs(1-e.color.v/100)+")",a.fillRect(0,0,o.width,o.height),s.globalAlpha=e.color.a/255,s.drawImage(r,0,0,o.width,o.height)},v=function(){let t=i.getBoundingBox(o),n=i.getBoundingBox(a);a.style.backgroundColor=e.color.toRGB().toString(),u||(a.style.left=t.width/2+t.width/2/100*e.color.s*Math.cos(i.degreesToRadians(e.color.h+90))-n.width/2+"px",a.style.top=t.height/2+t.width/2/100*e.color.s*Math.sin(i.degreesToRadians(e.color.h+90))-n.height/2+"px"),a.dataset.value1=e.color.h,a.dataset.value2=e.color.s},_=function(){l.thumb_mousedown=function(e){document.selection?document.selection.empty():window.getSelection().removeAllRanges(),u=!0},a.addEventListener("mousedown",l.thumb_mousedown,!0),a.addEventListener("touchstart",l.thumb_mousedown,!0),l.canvas_mousedown=function(e){document.selection?document.selection.empty():window.getSelection().removeAllRanges(),u=!0;let t=e.touches?e.touches[0].pageX:e.pageX,s=e.touches?e.touches[0].pageY:e.pageY,r=i.getBoundingBox(o),l=i.getBoundingBox(a),c=r.width/2,h=t,d=s,p=r.left+r.width/2,g=r.top+r.height/2,m=360*Math.atan2(d-g,h-p)/(2*Math.PI)-90;m<0&&(m+=360),Math.sqrt((h-p)*(h-p)+(d-g)*(d-g))>c?(a.style.left=r.width/2+c*Math.cos(i.degreesToRadians(m+90))-l.width/2+"px",a.style.top=r.height/2+c*Math.sin(i.degreesToRadians(m+90))-l.height/2+"px"):(a.style.left=t-r.left-l.width/2+"px",a.style.top=s-r.top-l.height/2+"px"),r=i.getBoundingBox(o),l=i.getBoundingBox(a);let v=r.left+r.width/2-(l.left+l.width/2),_=r.top+r.height/2-(l.top+l.height/2),b=Math.sqrt(Math.pow(v,2)+Math.pow(_,2)),w=m,E=Math.min(100,Math.ceil(b/c*100));n.values.hue=w,n.values.saturation=E,a.dataset.value1=w,a.dataset.value2=E,f("change",n.values)},o.addEventListener("mousedown",l.canvas_mousedown,!0),o.addEventListener("touchstart",l.canvas_mousedown,!0),l.document_mousemove=function(e){if(u){e.preventDefault(),e.stopImmediatePropagation();let t=e.touches?e.touches[0].pageX:e.pageX,s=e.touches?e.touches[0].pageY:e.pageY,r=i.getBoundingBox(o),u=i.getBoundingBox(a),l=r.width/2,c=t,h=s,d=r.left+r.width/2,p=r.top+r.height/2,g=360*Math.atan2(h-p,c-d)/(2*Math.PI)-90;g<0&&(g+=360),Math.sqrt((c-d)*(c-d)+(h-p)*(h-p))>l?(a.style.left=r.width/2+l*Math.cos(i.degreesToRadians(g+90))-u.width/2+"px",a.style.top=r.height/2+l*Math.sin(i.degreesToRadians(g+90))-u.height/2+"px"):(a.style.left=t-r.left-u.width/2+"px",a.style.top=s-r.top-u.height/2+"px"),r=i.getBoundingBox(o),u=i.getBoundingBox(a);let m=r.left+r.width/2-(u.left+u.width/2),v=r.top+r.height/2-(u.top+u.height/2),_=Math.sqrt(Math.pow(m,2)+Math.pow(v,2)),b=g,w=Math.min(100,Math.ceil(_/l*100));n.values.hue=b,n.values.saturation=w,a.dataset.value1=b,a.dataset.value2=w,f("change",n.values)}},document.addEventListener("mousemove",l.document_mousemove,!0),document.addEventListener("touchmove",l.document_mousemove,{passive:!1}),l.document_mouseup=function(e){u=!1},document.addEventListener("mouseup",l.document_mouseup,!0),document.addEventListener("touchend",l.document_mouseup,!0)},b=function(){a.removeEventListener("mousedown",l.thumb_mousedown,!1),a.removeEventListener("touchstart",l.thumb_mousedown,!1),o.removeEventListener("mousedown",l.canvas_mousedown,!1),o.removeEventListener("touchstart",l.canvas_mousedown,!1),document.removeEventListener("mousemove",l.document_mousemove,!1),document.removeEventListener("touchmove",l.document_mousemove,!1),document.removeEventListener("mouseup",l.document_mouseup,!1),document.removeEventListener("touchend",l.document_mouseup,!1)};this.update=function(e){m(),v()},this.dispose=function(){for(var e in b(),this.values=null,h=null,d=null,l.thumb_mousedown=null,l.canvas_mousedown=null,l.document_mousemove=null,l.document_mouseup=null,c.change.splice(0,c.change.length),c.change=null,n=null,s=null,o=null,r=null,a=null,u=null,t=null,l=null,c=null,f=null,p=null,g=null,m=null,v=null,_=null,b=null,this)delete this[e]},p()}function g({color_picker:e=null}){let t=this,n=e.root.querySelector(".color-picker-brightness-control"),s=n.querySelector("canvas"),o=n.querySelector(".color-picker-brightness-control-thumb"),r=!1,a={thumb_mousedown:null,canvas_mousedown:null,document_mousemove:null,document_mouseup:null},u={change:[]},l=e.color.v;Object.defineProperty(t,"value",{get:function(){return l},set:function(e){null!=e&&(e>100&&(e=100),e<0&&(e=0),l=e,t.update())},enumerable:!0,configurable:!0});let c=function(e,...n){u[e].forEach((e=>e(...n,t)))};this.on=function(e,t){return u[e]=u[e]||[],u[e].push(t),this},this.off=function(e,t){const n=u[e]||[],s=n.indexOf(t);return~s&&n.splice(s,1),this};let h=function(){d(),f(),p()},d=function(){let t=i.getBoundingBox(s);s.width=t.width,s.height=t.height;let n=s.getContext("2d").createLinearGradient(0,0,0,s.height),o=i.hsvToRgb(e.color.h,e.color.s,100),r=[0,0,0];n.addColorStop(0,"rgb("+o[0]+","+o[1]+","+o[2]+")"),n.addColorStop(1,"rgb("+r[0]+","+r[1]+","+r[2]+")"),s.getContext("2d").fillStyle=n,s.getContext("2d").fillRect(0,0,s.width,s.height)},f=function(){let n=i.getBoundingBox(s),a=i.getBoundingBox(o);o.style.backgroundColor=e.color.toRGB().toString(),o.style.left=n.width/2-a.width/2+"px",r||(o.style.top=-a.height/2+n.height*((100-t.value)/100)+"px"),o.dataset.value=t.value},p=function(){a.thumb_mousedown=function(e){document.selection?document.selection.empty():window.getSelection().removeAllRanges(),r=!0},o.addEventListener("mousedown",a.thumb_mousedown,!0),o.addEventListener("touchstart",a.thumb_mousedown,!0),a.canvas_mousedown=function(e){document.selection?document.selection.empty():window.getSelection().removeAllRanges(),r=!0;let n=e.touches?e.touches[0].pageY:e.pageY,a=i.getBoundingBox(s),u=i.getBoundingBox(o);o.style.left=a.width/2-u.width/2+"px",a.top<=n+u.height/2&&n+u.height/2<=a.top+a.height?o.style.top=n-a.top+"px":a.top>n+u.height/2?o.style.top=-u.height/2+"px":o.style.top=a.height-u.height/2+"px",a=i.getBoundingBox(s),u=i.getBoundingBox(o);let l=100-(u.top+u.height/2-a.top)/a.height*100;t.value=l,o.dataset.value=l,c("change",t.value)},s.addEventListener("mousedown",a.canvas_mousedown,!0),s.addEventListener("touchstart",a.canvas_mousedown,!0),a.document_mousemove=function(e){if(r){e.preventDefault(),e.stopImmediatePropagation();let n=e.touches?e.touches[0].pageY:e.pageY,r=i.getBoundingBox(s),a=i.getBoundingBox(o);o.style.left=r.width/2-a.width/2+"px",r.top<=n+a.height/2&&n+a.height/2<=r.top+r.height?o.style.top=n-r.top+"px":r.top>n+a.height/2?o.style.top=-a.height/2+"px":o.style.top=r.height-a.height/2+"px",r=i.getBoundingBox(s),a=i.getBoundingBox(o);let u=100-(a.top+a.height/2-r.top)/r.height*100;t.value=u,o.dataset.value=u,c("change",t.value)}},document.addEventListener("mousemove",a.document_mousemove,!0),document.addEventListener("touchmove",a.document_mousemove,{passive:!1}),a.document_mouseup=function(e){r=!1},document.addEventListener("mouseup",a.document_mouseup,!0),document.addEventListener("touchend",a.document_mouseup,!0)},g=function(){o.removeEventListener("mousedown",a.thumb_mousedown,!1),o.removeEventListener("touchstart",a.thumb_mousedown,!1),s.removeEventListener("mousedown",a.canvas_mousedown,!1),s.removeEventListener("touchstart",a.canvas_mousedown,!1),document.removeEventListener("mousemove",a.document_mousemove,!1),document.removeEventListener("touchmove",a.document_mousemove,!1),document.removeEventListener("mouseup",a.document_mouseup,!1),document.removeEventListener("touchend",a.document_mouseup,!1)};this.update=function(e){d(),f()},this.dispose=function(){for(var e in g(),this.value=null,l=null,a.thumb_mousedown=null,a.canvas_mousedown=null,a.document_mousemove=null,a.document_mouseup=null,u.change.splice(0,u.change.length),u.change=null,t=null,n=null,s=null,o=null,r=null,a=null,u=null,c=null,h=null,d=null,f=null,p=null,g=null,this)delete this[e]},h()}function m(e){this.root=e,this.min=Number(e.dataset.min),this.max=Number(e.dataset.max),this.step=Number(e.dataset.step)||1;let t=this,n=e.querySelector(".range-input"),s=e.querySelector(".range-input-progress"),o=e.querySelector(".range-input-value"),r=document.createElement("div"),a=!1,u=!1,l=null,c={root_mousedown:null,input_focusout:null,input_keyup:null},h={focus:[],blur:[],change:[]},d=Number(e.dataset.value)||0;Object.defineProperty(t,"value",{get:function(){return d},set:function(e){null!=e&&(null!=t.max&&e>t.max&&(e=t.max),null!=t.min&&e<t.min&&(e=t.min),d=i.round(Number(e),i.countDecimals(t.step)),n.value=d,o.innerHTML=d,null!=t.max&&(s.style.width=d/t.max*100+"%"),p("change",t.value))},enumerable:!0,configurable:!0});let f=!1;Object.defineProperty(t,"isFocused",{get:function(){return f},set:function(e){null!=e&&(f=e,f?(t.root.classList.add("range-input-control--focused"),p("focus",t)):(p("blur",t),t.root.classList.remove("range-input-control--focused")))},enumerable:!0,configurable:!0});let p=function(e,...n){h[e].forEach((e=>e(...n,t)))};this.on=function(e,t){return h[e]=h[e]||[],h[e].push(t),this},this.off=function(e,t){const n=h[e]||[],s=n.indexOf(t);return~s&&n.splice(s,1),this};let g=function(){n.value=t.value,o.innerHTML=Number(t.value).toFixed(i.countDecimals(t.step)),null!=t.max&&(s.style.width=t.value/t.max*100%NaN),m()},m=function(){c.root_mousedown=function(e){if(e.stopPropagation(),t.root.classList.contains("range-input-control--disabled")||t.root.classList.contains("range-input-control--mouse-move-mode")||t.root.classList.contains("range-input-control--key-input-mode"))return;t.isFocused=!0;let s=e.touches?e.touches[0].pageX:e.pageX;e.touches?e.touches[0].pageY:e.pageY,a=!0,u=!0,l=s,document.body.appendChild(r),r.focus(),t.root.classList.contains("range-input-control--mouse-move-mode")||t.root.classList.add("range-input-control--mouse-move-mode");let o=t.root.getBoundingClientRect(),i=function(e){if(!u)return;a=!1,e.stopPropagation&&e.stopPropagation(),e.preventDefault&&e.preventDefault();let n=e.touches?e.touches[0].pageX:e.pageX;e.touches?e.touches[0].pageY:e.pageY;let s=(n-l)/o.width*(t.max-t.min);0==n?t.value=t.value-t.step:n==window.screen.width-1?t.value=t.value+t.step:t.value=t.value+s,l=n},c=function(e){u&&(u=!1,t.root.classList.contains("range-input-control--mouse-move-mode")&&t.root.classList.remove("range-input-control--mouse-move-mode"),null!=r&&null!=r.parentNode&&document.body.removeChild(r)),a?(t.root.classList.contains("range-input-control--key-input-mode")||t.root.classList.add("range-input-control--key-input-mode"),n.focus(),n.select()):t.isFocused=!1,document.removeEventListener("mouseup",c,!1),document.removeEventListener("touchend",c,!1),document.removeEventListener("mousemove",i,!1),document.removeEventListener("touchmove",i,!1)};document.addEventListener("mouseup",c,{once:!0}),document.addEventListener("touchend",c,{once:!0}),document.addEventListener("mousemove",i,{passive:!1}),document.addEventListener("touchmove",i,{passive:!1})},t.root.addEventListener("mousedown",c.root_mousedown,!0),t.root.addEventListener("touchstart",c.root_mousedown,!0),c.input_focusout=function(e){t.root.classList.contains("range-input-control--key-input-mode")&&t.root.classList.remove("range-input-control--key-input-mode"),this.value=t.value,t.isFocused=!1},n.addEventListener("focusout",c.input_focusout),c.input_keyup=function(e){27===e.keyCode&&(e.preventDefault(),t.root.classList.contains("range-input-control--key-input-mode")&&t.root.classList.remove("range-input-control--key-input-mode"),this.value=t.value,t.isFocused=!1),13===e.keyCode&&(e.preventDefault(),t.root.classList.contains("range-input-control--key-input-mode")&&t.root.classList.remove("range-input-control--key-input-mode"),t.value=this.value,t.isFocused=!1)},n.addEventListener("keyup",c.input_keyup)},v=function(){t.root.removeEventListener("mousedown",c.root_mousedown,!1),t.root.removeEventListener("touchstart",c.root_mousedown,!1),n.removeEventListener("focusout",c.input_focusout,!1),n.removeEventListener("keyup",c.input_keyup,!1)};this.dispose=function(){for(var e in v(),this.value=null,d=null,this.isFocused=null,f=null,this.min=null,this.max=null,this.step=null,this.root.parentNode.removeChild(this.root),this.root=null,c.root_mousedown=null,c.input_focusout=null,c.input_keyup=null,h.focus.splice(0,h.focus.length),h.focus=null,h.blur.splice(0,h.blur.length),h.blur=null,h.change.splice(0,h.change.length),h.change=null,h=null,t=null,n=null,s=null,o=null,r=null,a=null,u=null,l=null,c=null,h=null,p=null,g=null,m=null,v=null,this)delete this[e]},g()}function v(e){this.root=e,this.isAlphanumeric=e.dataset.isAlphanumeric||!1;let t=this,n=e.querySelector(".text-input"),s=e.querySelector(".text-input-value"),o={root_mousedown:null,input_focusout:null,input_keydown:null,input_keyup:null},i={focus:[],blur:[],change:[]},r=e.dataset.value||"";Object.defineProperty(t,"value",{get:function(){return r},set:function(e){null!=e&&(r=e,n.value=r,s.innerHTML=r,u("change",t.value))},enumerable:!0,configurable:!0});let a=!1;Object.defineProperty(t,"isFocused",{get:function(){return a},set:function(e){null!=e&&(a=e,a?(t.root.classList.add("text-input-control--focused"),u("focus",t)):(u("blur",t),t.root.classList.remove("text-input-control--focused")))},enumerable:!0,configurable:!0});let u=function(e,...n){i[e].forEach((e=>e(...n,t)))};this.on=function(e,t){return i[e]=i[e]||[],i[e].push(t),this},this.off=function(e,t){const n=i[e]||[],s=n.indexOf(t);return~s&&n.splice(s,1),this};let l=function(){n.value=t.value,s.innerHTML=t.value,c()},c=function(){o.root_mousedown=function(e){if(e.stopPropagation(),t.root.classList.contains("text-input-control--disabled"))return;t.isFocused=!0;let s=function(e){n.focus(),n.select()};document.addEventListener("mouseup",s,{once:!0}),document.addEventListener("touchend",s,{once:!0})},t.root.addEventListener("mousedown",o.root_mousedown,!0),t.root.addEventListener("touchstart",o.root_mousedown,!0),o.input_focusout=function(e){this.value=t.value,t.isFocused=!1},n.addEventListener("focusout",o.input_focusout,!0),o.input_keydown=function(e){let n=e.keyCode||e.charCode;t.isAlphanumeric&&(!e.key.match(/[a-zA-Z0-9]/)||0==document.getSelection().toString().length&&37!==n&&39!==n&&6==this.value.length&&8!=n&&46!=n)&&e.preventDefault()},n.addEventListener("keydown",o.input_keydown,!0),o.input_keyup=function(e){27===e.keyCode&&(e.preventDefault(),this.value=t.value,t.isFocused=!1),13===e.keyCode&&(e.preventDefault(),t.value=this.value,t.isFocused=!1)},n.addEventListener("keyup",o.input_keyup,!0)},h=function(){t.root.removeEventListener("mousedown",o.root_mousedown,!1),t.root.removeEventListener("touchstart",o.root_mousedown,!1),n.removeEventListener("focusout",o.input_focusout,!1),n.removeEventListener("keydown",o.input_keydown,!1),n.removeEventListener("keyup",o.input_keyup,!1)};this.dispose=function(){for(var e in h(),this.value=null,r=null,this.isFocused=null,a=null,this.isAlphanumeric=null,this.root.parentNode.removeChild(this.root),this.root=null,o.root_mousedown=null,o.input_focusout=null,o.input_keydown=null,o.input_keyup=null,i.focus.splice(0,i.focus.length),i.focus=null,i.blur.splice(0,i.blur.length),i.blur=null,i.change.splice(0,i.change.length),i.change=null,i=null,t=null,n=null,s=null,o=null,i=null,u=null,l=null,c=null,h=null,this)delete this[e]},l()}this.open=()=>this.isOpen=!0,this.close=()=>this.isOpen=!1,this.update=function(){d(),s.color_wheel.values.hue=n.color.h,s.color_wheel.values.saturation=n.color.s,s.brightness_slider.value=n.color.v,s.hue_input.value=n.color.h,s.saturation_input.value=n.color.s,s.brightness_input.value=n.color.v;let e=i.hsvToRgb(n.color.h,n.color.s,n.color.v);s.red_input.value=e[0],s.green_input.value=e[1],s.blue_input.value=e[2];let o=i.hsvToHex(n.color.h,n.color.s,n.color.v);s.hex_input.value=o.join("").toUpperCase(),t.useAlpha&&(s.alpha_input.value=n.color.a),h()},this.dispose=function(){for(var e in d(),this.isOpen=null,a=null,this.color.dispose(),this.color=null,u=null,this.root.parentNode.removeChild(this.root),this.root=null,this.container=null,o.color_change=null,o.tab_selection_change=null,o.color_wheel_change=null,o.brightness_slider_change=null,o.hue_input_change=null,o.saturation_input_change=null,o.brightness_input_change=null,o.red_input_change=null,o.green_input_change=null,o.blue_input_change=null,o.alpha_input_change=null,o.hex_input_change=null,r.open.splice(0,r.open.length),r.open=null,r.change.splice(0,r.change.length),r.change=null,r.close.splice(0,r.close.length),r.close=null,s.color_wheel.dispose(),s.color_wheel=null,s.brightness_slider.dispose(),s.brightness_slider=null,s.tab_selection_buttons=null,s.red_input.dispose(),s.red_input=null,s.green_input.dispose(),s.green_input=null,s.blue_input.dispose(),s.blue_input=null,s.hue_input.dispose(),s.hue_input=null,s.saturation_input.dispose(),s.saturation_input=null,s.brightness_input.dispose(),s.brightness_input=null,s.hex_input.dispose(),s.hex_input=null,t.useAlpha&&s.alpha_input.dispose(),s.alpha_input=null,t=null,n=null,s=null,o=null,r=null,i=null,l=null,c=null,h=null,d=null,this)delete this[e]},c()}"undefined"!=typeof goog&&goog.declareModuleId("googleChromeLabs.textFragmentPolyfill.textFragmentUtils");let Hs=0;window.customElements.define("table-of-contents",class extends te{constructor(){super()}render(){return $`<nav role="navigation"><strong>Contents</strong> ${this.__children}</nav>`}}),window.customElements.define("tex-math",class extends xe{static get dependencies(){return[{name:"katex",version:"0.15.3",module:"dist/katex.mjs",main:"dist/katex.min.js",css:"dist/katex.min.css"}]}static get properties(){return{mode:{type:String},code:{type:String},leqno:{type:Boolean},fleqn:{type:Boolean,converter:e=>"false"!==e},minRuleThickness:{type:Number},definitions:{type:Array}}}constructor(){super(),this.mode="display",this.leqno=!1,this.fleqn=!1,this.definitions=this.hasAttribute("definitions")?JSON.parse(this.getAttribute("definitions")):[]}initialChildNodes(e){!this.hasAttribute("code")&&e.length&&(this.code=e[0].textContent)}addAugmentations(){let e=this.code;for(let t=0;t<this.definitions.length;t++){const{replace:n,symbol:s,id:o}=this.definitions[t];e=e.replaceAll(n,`\\htmlClass{maug maug-${o}}{${s}}`)}return e}prepareMath(){return this.addAugmentations()}render(){const e=this.getDependency("katex");if(!e||!this.code)return;const t="display"===this.mode,n={throwOnError:!1,displayMode:t,leqno:this.leqno,fleqn:this.fleqn,minRuleThickness:this.minRuleThickness,trust:({command:e})=>"\\htmlClass"===e,strict:e=>"htmlExtension"===e?"ignore":"warn"},s=document.createElement(t?"div":"span"),o=this.prepareMath();return e.render(o,s,n),setTimeout((()=>{const n=s.querySelectorAll(".enclosing");for(const s of n){const n=[...s.classList].find((e=>e.startsWith("maug-"))).slice("maug-".length);let{symbol:o,definition:i}=this.definitions.find((e=>e.id===n));o=o.replaceAll("@",""),i=i.replaceAll("@","");const r=document.createElement("span");r.className="math-aug-window",r.style.borderBottomColor="black",e.render(`${o}:\\text{${i}}`,r,{throwOnError:!1,displayMode:!1,leqno:this.leqno,fleqn:this.fleqn,minRuleThickness:this.minRuleThickness}),s.addEventListener("focusout",(()=>{r.style.display="none"})),s.addEventListener("keydown",(e=>{"Enter"==e.key?(r.style.display="inline-block",e.stopImmediatePropagation()):"Escape"==e.key&&(r.style.display="none")})),s.appendChild(r),r.appendChild(De(s,r,t)),r.style.display="none",s.addEventListener("click",(e=>{r.style.display="inline-block",e.stopImmediatePropagation()})),s.setAttribute("tabindex",0)}}),200),s}}),window.customElements.define("annotation-thread",class extends te{constructor(){super(),document.addEventListener("keydown",this.keyDown)}keyDown(e){const t=window.getSelection();if("h"!==e.key&&"t"!==e.key||!t.toString())return;e.stopPropagation();let n=t.getRangeAt(0),s=function(e){let t,n,s=Ps(e.commonAncestorContainer,e).flat(1),o=0!==s.length?s.map((e=>e.textContent)).join(""):e.startContainer.textContent,i=o.lastIndexOf(" ",e.startOffset),r=-1!==i?i:0;if(0===s.length)t=o.slice(e.endOffset).indexOf(" "),n=e.endOffset+(-1!==t?t:0);else{let i=s[s.length-1].length,r=o.length-i+e.endOffset;t=o.slice(r).indexOf(" "),n=r+(-1!==t?t:i)}return o.slice(r,n)}(n);const o=function(e,t,n){const s=((e,t=Date.now())=>{try{return hs(e,t)}catch(e){return console.error("Fragment generation error",e),e.isTimeout?{status:ls}:{status:cs}}})(t);if(0===s.status){const e=s.fragment,t=e.prefix?`${encodeURIComponent(e.prefix)}-,`:"",o=e.suffix?`,-${encodeURIComponent(e.suffix)}`:"";n+="#:~:text="+t+encodeURIComponent(e.textStart)+(e.textEnd?`,${encodeURIComponent(e.textEnd)}`:"")+o}return e=`"${e}"`,`https://twitter.com/intent/tweet?text=${encodeURIComponent(e)}&url=${encodeURIComponent(n)}`}(s,t,window.location.href);let i=((e,t=document)=>{if(e.startContainer.nodeType!=Node.TEXT_NODE||e.endContainer.nodeType!=Node.TEXT_NODE)return[];if(e.startContainer===e.endContainer){const n=t.createElement("mark");return n.setAttribute("class","annotation-highlight"),e.surroundContents(n),[n]}const n=e.startContainer,s=e.cloneRange();s.setEndAfter(n);const o=e.endContainer,i=e.cloneRange();i.setStartBefore(o);const r=[];e.setStartAfter(n),e.setEndBefore(o);const a=e=>!e.parentNode||a(e.parentNode)&&!("CITE-REF"===e.nodeName||"CROSS-REF"===e.nodeName||e.className&&e.classList.contains("enclosing")),u=t.createTreeWalker(e.commonAncestorContainer,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_TEXT,{acceptNode:function(t){return e.intersectsNode(t)&&a(t)?Ls.includes(t.tagName)||t.nodeType===Node.TEXT_NODE?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT}});let l=u.nextNode();for(;l;){if(l.nodeType===Node.TEXT_NODE){const e=t.createElement("mark");e.setAttribute("class","annotation-highlight"),l.parentNode.insertBefore(e,l),e.appendChild(l),r.push(e)}l=u.nextNode()}const c=t.createElement("mark");c.setAttribute("class","annotation-highlight"),s.surroundContents(c);const h=t.createElement("mark");return h.setAttribute("class","annotation-highlight"),i.surroundContents(h),[c,...r,h].filter((e=>{let t=e.getBoundingClientRect();return!(0===t.height&&0===t.width)}))})(n,document);function r(){const e=(new Date).getTime();e-Hs>200&&(Hs=e,window.open(o,"_blank"))}0!==i.length&&(i.forEach((e=>{var t;(t=e).addEventListener("mouseover",(()=>{i.forEach((e=>{e.classList.add("hovered")}))})),t.addEventListener("mouseout",(()=>{i.forEach((e=>{e.classList.remove("hovered")}))})),t.addEventListener("mousedown",r)})),function(e,t,n,s,o=null,i="Comment"){const r=document.createElement("div");r.classList.add("thread");let a=$`<div class="thread-info"><div class="thread-username">${t}</div><div class="thread-type">${i}</div></div><div class="thread-body"><div class="thread-text">${n}</div><div class="thread-comment">${o}</div></div><div class="thread-datetime">${s}</div>`;e.insertBefore(r,e.firstChild),Z(a,r)}(this.querySelector(".anno-threads"),"Test",s,(new Date).toString(),"Test test test test test."),t.removeAllRanges(),"t"===e.key&&r())}openTab(){let e=this.querySelector(".anno");e.open?(e.open=!1,e.style.transform="translate(0, 0)"):(e.open=!0,e.style.transform="translate(-420px, 0)")}openColor(){let e=this.querySelector(".anno-color"),t=this.querySelector(".anno-button"),n=this.querySelector(".anno-color-button"),s=this.querySelector(".anno-side-tray");e.open?(e.open=!1,s.style.width="30px",t.style.transform="translate(0, 0)",n.style.transform="translate(0, 0)",s.style.height="300px",n.textContent="+"):(e.open=!0,t.style.transform="translate(0, 118px)",n.style.transform="translate(0, 118px)",s.style.height="430px",s.style.width="180px",n.textContent="-")}firstUpdated(){this.colorPicker=new Ms({container:this.querySelector(".anno-color"),theme:"light"}),this.colorPicker.on("change",(e=>{document.querySelector("article").style.setProperty("--highlight-color",`hsla(${e.h},${e.s}%,${e.v}%, ${e.a})`),this.requestUpdate()})),this.requestUpdate()}render(){return $`<div class="anno"><div class="anno-tray"><div class="top-nav"><div class="title"><h2 style="margin:0">Discussions<h3></h3></h2></div></div><div class="anno-threads"></div></div><div class="anno-side-tray"><div class="anno-color"></div><div class="anno-color-button" @click="${this.openColor}">+</div><div class="anno-button" @click="${this.openTab}"><p style="transform:rotate(90deg) translate(-5px,-2px);margin:0">tweets</p></div></div></div>`}}),window.addEventListener("DOMContentLoaded",(()=>{Ce(document.querySelector("article"))}));

    </script>
</html>